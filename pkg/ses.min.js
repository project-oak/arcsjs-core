var so=Object.defineProperty;var no=(t,e)=>{for(var o in e)so(t,o,{get:e[o],enumerable:!0})};var bt={};no(bt,{Arc:()=>Gt,Chef:()=>$o,Composer:()=>Kt,DataStore:()=>Wt,Decorator:()=>it,EventEmitter:()=>Ce,Host:()=>lt,Parser:()=>pt,ParticleCook:()=>ut,Paths:()=>Le,Runtime:()=>Pe,Store:()=>qt,Surface:()=>Wo,fetchParticleCode:()=>Yt,initVanilla:()=>Qt,logFactory:()=>Ae,maybeFetchParticleCode:()=>Xt,pathForKind:()=>De,requireParticleBaseCode:()=>Te,requireParticleImplCode:()=>We,utils:()=>ht});var _t=Object.defineProperty,io=Object.getOwnPropertyNames,lo=(t,e,o)=>e in t?_t(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,co=(t,e)=>function(){return t&&(e=(0,t[io(t)[0]])(t=0)),e},Dt=(t,e)=>{for(var o in e)_t(t,o,{get:e[o],enumerable:!0})},mt=(t,e,o)=>(lo(t,typeof e!="symbol"?e+"":e,o),o),Lt={};Dt(Lt,{Particle:()=>st,ParticleApi:()=>Vt});var Je,Ye,Xe,Et,He,St,kt,Ne,Ue,xt,Me,jt,Vt,Tt,st,po=co({"pkg/js/core/Particle.js"(){({create:Je,assign:Ye,keys:Xe,values:Et,entries:He,defineProperty:St,setPrototypeOf:kt}=Object),Ne=globalThis.scope,{log:Ue,timeout:xt}=Ne,Me=()=>Je(null),jt=new class{get empty(){return this.length===0}get data(){return this}get pojo(){return this.data}get json(){return JSON.stringify(this.pojo)}get pretty(){return JSON.stringify(this.pojo,null,"  ")}get keys(){return Xe(this.data)}get length(){return Xe(this.data).length}get values(){return Et(this.data)}get entries(){return He(this.data)}set(t,e){this.data[t]=e}setByIndex(t,e){this.data[this.keys[t]]=e}add(...t){t.forEach(e=>this.data[Ne.makeKey()]=e)}push(...t){this.add(...t)}remove(t){He(this.data).find(([e,o])=>{if(o===t)return delete this.data[e],!0})}has(t){return this.data[t]!==void 0}get(t){return this.getByKey(t)}getByKey(t){return this.data[t]}getByIndex(t){return this.data[this.keys[t]]}delete(t){delete this.data[t]}deleteByIndex(t){delete this.data[this.keys[t]]}assign(t){Ye(this.data,t)}map(t){return this.values.map(t)}toString(){return this.pretty}},Vt=class{get template(){return null}shouldUpdate(t,e){return!0}async update(t,e,o){return null}shouldRender(t,e){return!0}render(t,e){return null}},Tt=t=>{let e=t;return{get:()=>e,set:o=>e=o}},st=class{pipe;impl;internal;constructor(t,e,o){this.pipe=e,this.impl=Je(t),St(this,"internal",Tt(Me())),this.internal.$busy=0,this.internal.beStateful=!0,this.internal.state=Me()}get log(){return this.pipe?.log||Ue}get template(){return this.impl?.template}get config(){return{template:this.template}}set inputs(t){this.internal.inputs=t,this.invalidateInputs()}get inputs(){return this.internal.inputs}get state(){return this.internal.state}async service(t){return this.pipe?.service?.(t)}invalidateInputs(){this.invalidate()}invalidate(){this.internal.validator||(this.internal.validator=xt(this.validate.bind(this),1))}async(t){return Promise.resolve().then(t.bind(this))}async validate(){if(this.internal.validator){try{this.internal.$validateAfterBusy=this.internal.$busy,this.internal.$busy||(this.internal.beStateful||(this.internal.state=Me()),this.internal.inputs=this.validateInputs(),await this.maybeUpdate())}catch(t){Ue.error(t)}this.internal.validator=null}}validateInputs(){let t=Ye(Me(),this.inputs);return He(t).forEach(([e,o])=>{o&&typeof o=="object"&&(Array.isArray(o)||(o=kt({...o},jt)),t[e]=o)}),t}implements(t){return typeof this.impl?.[t]=="function"}async maybeUpdate(){await this.checkInit()&&(this.canUpdate()||this.outputData(null),await this.shouldUpdate(this.inputs,this.state)&&this.update())}async checkInit(){return this.internal.initialized||(this.internal.initialized=!0,this.implements("initialize")&&await this.asyncMethod(this.impl.initialize)),!0}canUpdate(){return this.implements("update")}async shouldUpdate(t,e){return!this.impl?.shouldUpdate||await this.impl.shouldUpdate(t,e)!==!1}update(){this.asyncMethod(this.impl?.update)}outputData(t){this.pipe?.output?.(t,this.maybeRender())}maybeRender(){if(this.template){let{inputs:t,state:e}=this.internal;if(this.impl?.shouldRender?.(t,e)!==!1)return this.implements("render")?this.impl.render(t,e):{...t,...e}}}async handleEvent({handler:t,data:e}){let o=this.impl?.[t];o&&(this.internal.inputs.eventlet=e,await this.asyncMethod(o.bind(this.impl),{eventlet:e}),this.internal.inputs.eventlet=null)}async asyncMethod(t,e){if(t){let{inputs:o,state:l}=this.internal,n={service:async p=>this.service(p),invalidate:()=>this.invalidate(),output:async p=>this.outputData(p)},i=t.bind(this.impl,o,l,{...n,...e});this.outputData(await this.try(i)),!this.internal.$busy&&this.internal.$validateAfterBusy&&this.invalidate()}}async try(t){this.internal.$busy++;try{return await t()}catch(e){Ue.error(e)}finally{this.internal.$busy--}}},Ne.harden(globalThis),Ne.harden(st)}}),Ce=class{listeners={};getEventListeners(t){return this.listeners[t]||(this.listeners[t]=[])}fire(t,...e){let o=this.getEventListeners(t);o?.forEach&&o.forEach(l=>l(...e))}listen(t,e,o){return this.getEventListeners(t).push(e),e._name=o||"(unnamed listener)",e}unlisten(t,e){let o=this.getEventListeners(t),l=typeof e=="string"?o.findIndex(n=>n._name===e):o.indexOf(e);l>=0?o.splice(l,1):console.warn("failed to unlisten from",t)}},uo=["log","group","groupCollapsed","groupEnd","dir"],mo=["warn","error"],{fromEntries:At}=Object,Ot=(t,e,o,l="log")=>{if(!t)return()=>{};if(l==="dir")return console.dir.bind(console);let n=`background: ${o||"gray"}; color: white; padding: 1px 6px 2px 7px; border-radius: 6px 0 0 6px;`;return console[l].bind(console,`%c${e}`,n)},ne=(t,e,o="")=>{let l=At(uo.map(a=>[a,Ot(t,e,o,a)])),n=At(mo.map(a=>[a,Ot(!0,e,o,a)])),i={...l,...n},p=i.log;return Object.assign(p,i),p};ne.flags=globalThis.config?.logFlags||{};var yo=t=>ne(ne.flags.arc,`Arc (${t})`,"slateblue"),{assign:go,keys:Ze,entries:It,create:fo}=Object,Qe=t=>Object.values(t),et=()=>fo(null),Gt=class extends Ce{log;id;meta;stores;hosts;surface;composer;hostService;constructor(t,e,o){super(),this.id=t,this.meta=e,this.surface=o,this.hosts=et(),this.stores=et(),this.log=yo(t)}async addHost(t,e){return await this.ensureComposer(),this.hosts[t.id]=t,t.arc=this,this.updateHost(t),t}async ensureComposer(){!this.composer&&this.surface&&(this.composer=await this.surface.createComposer("root"),this.composer.onevent=this.onevent.bind(this))}removeHost(t){this.hosts[t]?.detach(),delete this.hosts[t]}addStore(t,e){e&&!this.stores[t]&&(this.stores[t]=e,e.listen("change",()=>this.storeChanged(t,e),this.id))}removeStore(t){let e=this.stores[t];e&&e.unlisten("change",this.id),delete this.stores[t]}storeChanged(t,e){this.log(`storeChanged: "${t}"`);let o=l=>l&&l.some(n=>Qe(n)[0]==t||Ze(n)[0]==t);Qe(this.hosts).forEach(l=>{let n=l.meta?.inputs;(n==="*"||o(n))&&(this.log(`host "${l.id}" has interest in "${t}"`),this.updateHost(l))}),this.fire("store-changed",t)}updateParticleMeta(t,e){let o=this.hosts[t];o.meta=e,this.updateHost(o)}updateHost(t){t.inputs=this.computeInputs(t)}computeInputs(t){let e=et(),o=t.meta?.inputs;if(o==="*")It(this.stores).forEach(([l,n])=>e[l]=n.pojo);else{let l=t.meta?.staticInputs;go(e,l),o&&(o.forEach(n=>this.computeInput(It(n)[0],e)),this.log(`computeInputs(${t.id}) =`,e))}return e}computeInput([t,e],o){let l=e||t,n=this.stores[l];n?o[t]=n.pojo:this.log.warn(`computeInput: "${l}" (bound to "${t}") not found`)}assignOutputs({id:t,meta:e},o){let l=Ze(o);e?.outputs&&l.length&&(l.forEach(n=>this.assignOutput(n,o[n],e.outputs)),this.log(`[end][${t}] assignOutputs:`,o))}assignOutput(t,e,o){if(e!==void 0){let l=this.findOutputByName(o,t)||t,n=this.stores[l];n?(this.log(`assignOutputs: "${t}" is dirty, updating Store "${l}"`,e),n.data=e):o?.[t]&&this.log.warn(`assignOutputs: no "${l}" store for output "${t}"`)}}findOutputByName(t,e){let o=t?.find(l=>Ze(l)[0]===e);if(o)return Qe(o)[0]}async render(t){this.composer&&this.composer.render(t)}onevent(t,e){let o=this.hosts[t];o&&o.handleEvent(e)}async service(t,e){let o=await this.surface?.service(e);return o===void 0&&(o=this.hostService?.(t,e)),o}},ho=(t,e)=>{let o=e;if(e){if(Array.isArray(e)){Array.isArray(t)||(t=[]);for(let n=0;n<e.length;n++){let i=e[n];t[n]!==i&&(t[n]=i)}let l=t.length-e.length;l>0&&t.splice(e.length,l)}else if(typeof e=="object"){o=t&&typeof t=="object"?t:Object.create(null);let l={};Object.keys(e).forEach(n=>{o[n]=e[n],l[n]=!0}),Object.keys(o).forEach(n=>{l[n]||delete o[n]})}}return o},bo=(t,e)=>{if(e==null)return null;if(typeof e=="object"){let o=t&&typeof t=="object"?t:Object.create(null);return Object.keys(e).forEach(l=>o[l]=e[l]),o}return e};function je(t){if(t){if(Array.isArray(t))return t.map(e=>je(e));if(typeof t=="object"){let e=Object.create(null);return Object.entries(t).forEach(([o,l])=>{e[o]=je(l)}),e}else return t}else return t}var ze=(t,e)=>{let o=typeof t;if(o!==typeof e)return!1;if(o==="object"&&t&&e){let l=Object.getOwnPropertyNames(t),n=Object.getOwnPropertyNames(e);return l.length==n.length&&!l.some(i=>!ze(t[i],e[i]))}return t===e},Ht=t=>t===void 0?null:(t&&typeof t=="object"&&Object.getOwnPropertyNames(t).forEach(o=>{let l=t[o];l===void 0?delete t[o]:Ht(l)}),t),{floor:Ut,pow:vo,random:dt}=Math,wo=t=>Ut((1+dt()*9)*vo(10,t-1)),yt=t=>Ut(dt()*t),$e=t=>t[yt(t.length)],Po=t=>Boolean(dt()<t),nt=ne(ne.flags.decorator,"Decorator","plum"),{values:Eo,entries:zt}=Object,Ct={},it={setOpaqueData(t,e){return Ct[t]=je(e),t},getOpaqueData(t){return Ct[t]},maybeDecorateModel(t,e){return t&&!Array.isArray(t)&&Eo(t).forEach(o=>{o&&typeof o=="object"&&(o.models?(nt("applying decorator(s) to list:",o),this.maybeDecorateItem(o,e)):(t?.filter||t?.decorator||t?.collateBy)&&(nt("scanning for lists in sub-model:",o),this.maybeDecorateModel(o,e)))}),t},maybeDecorateItem(t,e){let o=typeof t.models=="string"?this.getOpaqueData(t.models):t.models;o=So(o,t.decorator,e),o=ko(o,t.filter,e.impl),o=xo(o,t),t.models=o}},So=(t,e,o)=>{e=o.impl[e]??e;let{inputs:l,state:n}=o.internal;if(e){let i=Object.freeze(je(l)),p=Object.freeze(je(n));t=t.map(a=>{a.privateData=a.privateData||{};let d=Object.freeze(je(a)),h=e(d,i,p);return a.privateData=h.privateData,{...h,...a}}),t.sort(jo("sortKey")),nt("decoration was performed")}return t},ko=(t,e,o)=>(e=o[e]??e,e&&t&&(t=t.filter(e)),t),xo=(t,e)=>(zt(e).forEach(([o,l])=>{if(l?.collateBy){let n=Ao(t,l.collateBy);t=Oo(n,o,l.$template)}}),t),jo=t=>(e,o)=>To(String(e[t]).toLowerCase(),String(o[t]).toLowerCase()),To=(t,e)=>t<e?-1:t>e?1:0,Ao=(t,e)=>{let o={};return t.forEach(l=>{let n=l[e];n&&(o[n]||(o[n]=[])).push(l)}),o},Oo=(t,e,o)=>zt(t).map(([l,n])=>({key:l,[e]:{models:n,$template:o},single:n.length===1,...n?.[0]})),{entries:Ft,keys:Io}=Object,Co=t=>ne(ne.flags.host,`Host (${t})`,$e(["#5a189a","#51168b","#48137b","#6b2fa4","#7b46ae","#3f116c"])),lt=class extends Ce{arc;id;lastOutput;log;meta;particle;constructor(t){super(),this.log=Co(t),this.id=t}onevent(t){this.arc?.onevent(t)}installParticle(t,e){this.particle&&this.detachParticle(),t&&(this.particle=t,this.meta=e||this.meta)}get container(){return this.meta?.container||"root"}detach(){this.detachParticle(),this.arc=null}detachParticle(){let{particle:t}=this;t&&(this.render({$clear:!0}),this.particle=null,this.meta=null)}async service(t){return t?.decorate?it.maybeDecorateModel(t.model,this.particle):this.arc?.service(this,t)}output(t,e){t&&(this.lastOutput=t,this.arc?.assignOutputs(this,t)),this.template&&(it.maybeDecorateModel(e,this.particle),this.log(e),this.render(e))}render(t){let{id:e,container:o,template:l}=this;this.arc?.render({id:e,container:o,content:{template:l,model:t}})}set inputs(t){if(this.particle&&t){let e=this.particle.internal.inputs;this.dirtyCheck(t,e,this.lastOutput)?(this.particle.inputs={...this.meta?.staticInputs,...t},this.fire("inputs-changed")):this.log("inputs are uninteresting, skipping update")}}dirtyCheck(t,e,o){let l=([n,i])=>o?.[n]&&!ze(o[n],i)||!ze(e?.[n],i);return!e||Ft(t).length!==this.lastInputsLength(e)||Ft(t).some(l)}lastInputsLength(t){return Io(t).filter(e=>!this.meta?.staticInputs?.[e]&&e!=="eventlet").length}get config(){return this.particle?.config}get template(){return this.config?.template}invalidate(){this.particle?.invalidate()}handleEvent(t){return this.particle?.handleEvent(t)}},{create:Fo,keys:Ro}=Object,{stringify:Rt,parse:$t}=JSON,Wt=class extends Ce{privateData;constructor(){super()}setPrivateData(t){this.privateData=t}set data(t){this.setPrivateData(t)}get data(){return this.privateData}toString(){return this.pretty}get isObject(){return this.data&&typeof this.data=="object"}get pojo(){return this.data}get json(){return Rt(this.data)}set json(t){let e=null;try{e=$t(t)}catch{}this.data=e}get pretty(){let t={},e=this.pojo;return Ro(e).sort().forEach(o=>t[o]=e[o]),Rt(t,null,"  ")}},No=class extends Wt{change(t){t(this),this.doChange()}doChange(){this.fire("change",this),this.onChange(this)}onChange(t){}set data(t){this.change(e=>e.setPrivateData(t))}get data(){return this.privateData}set(t,e){this.data||this.setPrivateData(Fo(null)),e!==void 0?this.change(o=>o.data[t]=e):this.delete(t)}delete(t){this.change(e=>delete e.data[t])}},Mo=class extends No{meta;persistor;willPersist;constructor(t){super(),this.meta={...t}}toString(){return`${JSON.stringify(this.meta,null,"  ")}, ${this.pretty}`}get tags(){return this.meta.tags??(this.meta.tags=[])}is(...t){return t.every(e=>this.tags.includes(e))}isCollection(){return this.meta.type?.[0]==="["}async doChange(){return this.persist(),super.doChange()}async persist(){!this.willPersist&&this.persistor&&(this.willPersist=!0,setTimeout(()=>{this.willPersist=!1,this.persistor.persist(this)},500))}async restore(t){!await this.persistor?.restore(this)&&t!==void 0&&(this.data=t)}delete(){this.persistor?.remove(this)}save(){return this.json}load(t,e){let o=e;try{t&&(o=$t(t))}catch{}o!==void 0&&(this.data=o)}},qt=class extends Mo{},ct=(t,e,o)=>{t=t||2,e=e||2,o=o||"-";let l=Math.pow(10,e-1),n=Math.pow(10,e)-l,i=[];for(let p=0;p<t;p++)i.push(`${yt(n-l)+l}`);return i.join(o)},Nt=ne(ne.flags.runtime,"runtime","#873600"),Mt={},tt={},{keys:_o}=Object,Oe=class extends Ce{log;uid;nid;arcs;stores;peers;shares;endpoint;network;surfaces;persistor;prettyUid;constructor(t){t=t||"user",super(),this.arcs={},this.surfaces={},this.stores={},this.peers=new Set,this.shares=new Set,this.setUid(t),this.log=ne(ne.flags.runtime,`runtime:[${this.prettyUid}]`,"#873600"),Oe.securityLockdown?.(Oe.particleOptions)}setUid(t){this.uid=t,this.nid=`${t}:${ct(1,2)}`,this.prettyUid=t.substring(0,t.indexOf("@")+1)||t}async bootstrapArc(t,e,o,l){let n=new Gt(t,e,o);return n.hostService=this.serviceFactory(l),await this.addArc(n),n}serviceFactory(t){return async(e,o)=>t.handle(this,e,o)}async bootstrapParticle(t,e,o){let l=new lt(e);await this.marshalParticle(l,o);let n=t.addHost(l);return Nt("bootstrapped particle",e),n}addSurface(t,e){this.surfaces[t]=e}getSurface(t){return this.surfaces[t]}addArc(t){let{id:e}=t;if(e&&!this.arcs[e])return this.arcs[e]=t;throw`arc has no id, or id "${e}" is already in use`}removeArc(t){let{id:e}=t;if(!e||!this.arcs[e])throw e?`id "${e}" is not in use`:"arc has no id";delete this.arcs[e]}async marshalParticle(t,e){let o=await this.createParticle(t,e.kind);t.installParticle(o,e)}async installParticle(t,e,o){if(this.log("installParticle",o,e,t.id),o=o||ct(),t.hosts[o]){let n=1;for(;t.hosts[`${o}-${n}`];n++);o=`${o}-${n}`}let l=new lt(o);return await this.marshalParticle(l,e),t.addHost(l),l}addStore(t,e){e.marshal&&e.marshal(this),e.persistor&&(e.persistor.persist=n=>this.persistor?.persist(t,n));let o=`${this.nid}:${t}-changed`,l=this.storeChanged.bind(this,t);e.listen("change",l,o),this.stores[t]=e,this.maybeShareStore(t)}storeChanged(t,e){this.log("storeChanged",t),this.network?.invalidatePeers(t),this.onStoreChange(t,e),this.fire("store-changed",{storeId:t,store:e})}onStoreChange(t,e){}do(t,e){e(this.stores[t])}removeStore(t){this.do(t,e=>{e?.unlisten("change",`${this.nid}:${t}-changed`)}),delete this.stores[t]}maybeShareStore(t){this.do(t,e=>{e?.is("shared")&&this.shareStore(t)})}addPeer(t){this.peers.add(t),[...this.shares].forEach(e=>this.maybeShareStoreWithPeer(e,t))}shareStore(t){this.shares.add(t),[...this.peers].forEach(e=>this.maybeShareStoreWithPeer(t,e))}maybeShareStoreWithPeer(t,e){this.do(t,o=>{let l=this.uid.replace(/\./g,"_");(!o.is("private")||e.startsWith(l))&&this.shareStoreWithPeer(t,e)})}shareStoreWithPeer(t,e){this.network?.shareStore(t,e)}async createParticle(t,e){try{return(await this.marshalParticleFactory(e))(t)}catch(o){Nt.error(`createParticle(${e}):`,o)}}async marshalParticleFactory(t){return Mt[t]??this.lateBindParticle(t)}lateBindParticle(t){return Oe.registerParticleFactory(t,Oe?.particleIndustry(t,Oe.particleOptions))}static registerParticleFactory(t,e){return Mt[t]=e}requireStore(t){let e=this.stores[t.name];return e||(e=this.createStore(t),this.addStore(t.name,e)),e}createStore(t){let e=_o(tt).find(l=>t.tags?.includes?.(l)),o=tt[String(e)]||qt;return new o(t)}static registerStoreClass(t,e){tt[t]=e}},Pe=Oe;mt(Pe,"securityLockdown");mt(Pe,"particleIndustry");mt(Pe,"particleOptions");var rt=ne(ne.flags.recipe,"flan","violet"),{entries:Do,create:Lo}=Object,pt=class{stores;particles;slots;meta;constructor(t){this.stores=[],this.particles=[],this.slots=[],this.meta=Lo(null),t&&this.parse(t)}parse(t){let e=this.normalize(t);return this.parseSlotSpec(e,"root",""),this}normalize(t){if(typeof t!="object")throw Error("recipe must be an Object");return t}parseSlotSpec(t,e,o){for(let l in t)switch(l){case"$meta":this.meta={...this.meta,...t.$meta};break;case"$stores":this.parseStoresNode(t.$stores);break;default:{let n=o?`${o}#${e}`:e;this.parseParticleSpec(n,l,t[l]);break}}}parseStoresNode(t){for(let e in t)this.parseStoreSpec(e,t[e])}parseStoreSpec(t,e){if(this.stores.find(l=>l.name===t)){rt("duplicate store name");return}let o={name:t,type:e.$type,tags:e.$tags,value:e.$value};this.stores.push(o)}parseParticleSpec(t,e,o){if(!o.$kind)throw rt.warn('parseParticleSpec: malformed spec has no "kind":',o),Error();if(this.particles.find(l=>l.id===e)){rt("duplicate particle name");return}this.particles.push({id:e,container:t,spec:o}),o.$slots&&this.parseSlotsNode(o.$slots,e)}parseSlotsNode(t,e){Do(t).forEach(([o,l])=>this.parseSlotSpec(l,o,e))}};function Bt(t,e){for(let o in e)if(t[o]!==e[o])return!1;return!0}var ot=ne(ne.flags.recipe,"StoreCook","#187e13"),{values:Vo}=Object,Go=(t,e)=>Vo(t.stores).filter(o=>Bt(o?.meta,e)),Ho=(t,{name:e,type:o})=>Go(t,{name:e,type:o})?.[0],Uo=class{static async execute(t,e,o){return this.forEachStore(this.realizeStore,t,e,o)}static async evacipate(t,e,o){return this.forEachStore(this.derealizeStore,t,e,o)}static async forEachStore(t,e,o,l){return Promise.all(l.map(n=>t.call(this,e,o,n)))}static async realizeStore(t,e,o){let l=this.constructMeta(t,e,o),n=Ho(t,l);n&&ot(`realizeStore: mapped "${o.name}" to "${n.meta.name}"`),n?(ot(`realizeStore: mapped to "${l.name}", setting data to:`,l?.value),l?.value!==void 0&&(n.data=l?.value)):(n=t.createStore(l),n&&(n.persistor={restore:i=>t.persistor?.restore(l.name,i),persist:()=>{}}),t.addStore(l.name,n),await n?.restore(l?.value),ot(`realizeStore: created "${l.name}"`)),e.addStore(l.name,n)}static async derealizeStore(t,e,o){t.removeStore(o.$name),e.removeStore(o.$name)}static constructMeta(t,e,o){let l={...o,arcid:e.id,uid:t.uid};return{...l,owner:l.uid,shareid:`${l.name}:${l.arcid}:${l.uid}`}}},zo=ne(ne.flags.recipe,"ParticleCook","#096f33"),ut=class{static async execute(t,e,o){for(let l of o)await this.realizeParticle(t,e,l)}static async realizeParticle(t,e,o){zo("realizedParticle:",o.id);let l=this.specToMeta(o.spec);return l.container||=o.container,t.bootstrapParticle(e,o.id,l)}static specToMeta(t){let{$kind:e,$container:o,$staticInputs:l}=t,n=this.formatBindings(t.$inputs),i=this.formatBindings(t.$outputs);return{kind:e,staticInputs:l,inputs:n,outputs:i,container:o}}static formatBindings(t){return t?.map?.(e=>typeof e=="string"?{[e]:e}:e)}static async evacipate(t,e,o){return Promise.all(o.map(l=>this.derealizeParticle(t,e,l)))}static async derealizeParticle(t,e,o){e.removeHost(o.id)}},_e=ne(ne.flags.recipe,"Chef","#087f23"),$o=class{static async execute(t,e,o){if(o instanceof Promise){_e.error("`arc` must be an Arc, not a Promise. Make sure `boostrapArc` is awaited.");return}_e("|-->...| executing recipe: ",t.$meta??"");let l=new pt(t);await Uo.execute(e,o,l.stores),await ut.execute(e,o,l.particles),o.meta={...o.meta,...l.meta},_e("|...-->| recipe complete: ",t.$meta??"")}static async evacipate(t,e,o){_e("|-->...| evacipating recipe: ",t.$meta);let l=new pt(t);await ut.evacipate(e,o,l.particles),_e("|...-->| recipe evacipated: ",t.$meta)}static async executeAll(t,e,o){for(let l of t)await this.execute(l,e,o)}static async evacipateAll(t,e,o){return Promise.all(t?.map(l=>this.evacipate(l,e,o)))}},at=ne(ne.flags.composer,"composer","red"),Kt=class extends Ce{slots;pendingPackets;constructor(){super(),this.slots={},this.pendingPackets=[]}activate(){this.fire("activate")}processPendingPackets(){let t=this.pendingPackets;t.length&&(this.pendingPackets=[],t.forEach(e=>{e.pendCount=(e.pendCount||0)+1,this.render(e)}))}render(t){let{id:e,container:o,content:{template:l,model:n}}=t;at({id:e,container:o,model:n});let i=this.slots[e];if(n?.$clear){i&&(this.processPendingPackets(),this.slots[e]=null,this.clearSlot(i));return}if(!i){let p=this.findContainer(o);if(!p){this.pendingPackets.push(t),++t.pendCount%1e4===0&&at.warn(`container [${o}] unavailable for slot [${e}] (x1e4)`);return}i=this.generateSlot(e,l,p),this.slots[e]=i}i&&n&&(this.maybeReattachSlot(i,o),i.set(n),this.processPendingPackets())}clearSlot(t){}findContainer(t){return null}generateSlot(t,e,o){return null}maybeReattachSlot(t,e){}onevent(t,e){at(`[${t}] sent [${e.handler}] event`)}requestFontFamily(t){return!1}},Pa=ne(ne.flags.composer,"surface","tomato"),Wo=class{async createComposer(t){return await this.createComposerInstance(t)}async createComposerInstance(t){return new Kt}async service(t){}},Jt=class{map;constructor(t){this.map={},this.setRoot(t)}add(t){Object.assign(this.map,t||{})}resolve(t){let e=t.split("/"),o=e.shift();return[this.map[o]||o,...e].join("/")}setRoot(t){t.length&&t[t.length-1]==="/"&&(t=t.slice(0,-1)),this.add({$root:t,$arcs:t})}getAbsoluteHereUrl(t,e){let o=t.url.split("/").slice(0,-(e??1)).join("/");if(globalThis?.document){let l=document.URL;l[l.length-1]!=="/"&&(l=l.split("/").slice(0,-1).join("/"));let n=new URL(o,l).href;return n[n.length-1]==="/"&&(n=n.slice(0,-1)),n}else return o}},qo=import.meta.url.split("/").slice(0,-3).join("/"),Ie=globalThis.Paths=new Jt(qo);Ie.add(globalThis.config?.paths);var gt=ne(ne.flags.code,"code","gold"),Bo="$arcs/js/core/Particle.js",Te=async t=>{if(!Te.source){let e=Ie.resolve(t||Bo);gt("particle base code path: ",e);let l=await(await fetch(e)).text()+`
//# sourceURL=`+e+`
`;Te.source=l.replace(/export /g,"")}return Te.source};Te.source=null;var We=async(t,e)=>{let o=e?.code||await Yt(t);return o.slice(o.indexOf("({"))},Yt=async t=>{if(t)return await Xt(t);gt.error("fetchParticleCode: empty 'kind'")},Xt=async t=>{let e=De(t);try{return await(await fetch(e)).text()}catch{gt.error(`could not locate implementation for particle "${t}" [${e}]`)}},De=t=>t?(!"$./".includes(t[0])&&!t.includes("://")&&(t=`$library/${t}`),t?.split("/").pop().includes(".")||(t=`${t}.js`),Ie.resolve(t)):"404",ft=ne(ne.flags.ses,"vanilla","goldenrod"),Zt=t=>t;globalThis.harden=Zt;globalThis.scope={harden:Zt};var Ko=()=>`i${Math.floor((1+Math.random()*9)*1e14)}`,Jo=async(t,e)=>new Promise(o=>setTimeout(()=>o(t()),e)),Qt=t=>{try{let o={...{log:ft,resolve:er,html:tr,makeKey:Ko,timeout:Jo},...t?.injections};Object.assign(globalThis.scope,o),Object.assign(globalThis,o)}finally{}},er=Ie.resolve.bind(Ie),tr=(t,...e)=>`${t[0]}${e.map((o,l)=>`${o}${t[l+1]}`).join("")}`.trim(),Yo=async(t,e)=>{let{Particle:o}=await Promise.resolve().then(()=>(po(),Lt)),l=await Xo(t,e),n=ea(t),i={log:n,resolve:er,html:tr,...e?.injections},p=l(i);return d=>{let h={log:n,output:d.output.bind(d),service:d.service.bind(d)};return new o(p,h,!0)}},Xo=async(t,e)=>{let o=await We(t,e),l=(0,eval)(o);return typeof l=="object"&&(l=Zo(l,t),ft(`repackaged factory:
`,l)),globalThis.harden(l)},Zo=(t,e)=>{let{constNames:o,rewriteConsts:l,funcNames:n,rewriteFuncs:i}=Qo(t),p=`{${[...o,...n]}}`,a=`
({log, ...utils}) => {
// protect utils
globalThis.harden(utils);
// these are just handy
const {assign, keys, entries, values, create} = Object;
// declarations
${[...l,...i].join(`

`)}
// hardened Object (map) of declarations,
// suitable to be a prototype
return globalThis.harden(${p});
// name the file for debuggers
//# sourceURL=sandbox/${De(e).split("/").pop()}
};
  `;return ft(`rewritten:

`,a),(0,eval)(a)},Qo=t=>{let e=Object.entries(t),o=([c,r])=>typeof r=="function",l=([c,r])=>c=="harden"||c=="globalThis",n=e.filter(c=>o(c)&&!l(c)),i=n.map(([c,r])=>{let v=r?.toString?.()??"",s=v.includes("async"),m=v.replace("async ","").replace("function ","");return`${s?"async":""} function ${m};`}),p=n.map(([c])=>c),a=e.filter(c=>!o(c)&&!l(c)),d=a.map(([c,r])=>`const ${c} = \`${r}\`;`);return{constNames:a.map(([c])=>c),rewriteConsts:d,funcNames:p,rewriteFuncs:i}},ea=t=>{let e=ne(ne.flags.particles,t,"#002266");return(o,...l)=>{let i=(o?.stack?.split(`
`)?.slice(1,2)||new Error().stack?.split(`
`).slice(2,3)).map(p=>p.replace(/\([^()]*?\)/,"").replace(/ \([^()]*?\)/,"").replace("<anonymous>, <anonymous>","").replace("Object.","").replace("eval at :","").replace(/\(|\)/g,"").replace(/\[[^\]]*?\] /,"").replace(/at (.*) (\d)/,'at "$1" $2')).reverse().join(`
`).trim();o?.message?e.error(o.message,...l,`(${i})`):e(o,...l,`(${i})`)}};Pe.particleIndustry=Yo;Pe.securityLockdown=Qt;var ht={};Dt(ht,{PathMapper:()=>Jt,Paths:()=>Ie,arand:()=>$e,async:()=>na,asyncTask:()=>ia,computeAgeString:()=>ta,debounce:()=>sa,deepCopy:()=>je,deepEqual:()=>ze,deepUndefinedToNull:()=>Ht,irand:()=>yt,kebabToCaps:()=>or,key:()=>wo,logFactory:()=>ne,makeCapName:()=>ra,makeId:()=>ct,makeName:()=>rr,matches:()=>Bt,prob:()=>Po,shallowMerge:()=>bo,shallowUpdate:()=>ho});var ta=(t,e)=>{let o=Math.round((e-t)/1e3);if(isNaN(o))return"\u2022";let l="";return o<60?(o>1&&(l="s"),`${o} second${l} ago`):(o=Math.round(o/60),o<60?(o>1&&(l="s"),`${o} minute${l} ago`):(o=Math.round(o/60),o<24?(o>1&&(l="s"),`${o} hour${l} ago`):(o=Math.round(o/24),o<30?(o>1&&(l="s"),`${o} day${l} ago`):(o=Math.round(o/30),o<12?(o>1&&(l="s"),`${o} month${l} ago`):(o=Math.round(o/12),o>1&&(l="s"),`${o} year${l} ago`)))))},rr=t=>`${$e(oa)}${t||"-"}${$e(aa)}`,ra=()=>or(rr()),or=t=>{let e=[];for(let o=0,l;l=t[o];o++)e.push(o>0&&l!=="-"?l:t[o>0?++o:o].toUpperCase());return e.join("")},oa=["abandoned","able","absolute","adorable","adventurous","academic","acceptable","acclaimed","accomplished","accurate","aching","acidic","acrobatic","active","actual","adept","admirable","admired","adolescent","adorable","adored","advanced","afraid","affectionate","aged","aggravating","aggressive","agile","agitated","agonizing","agreeable","ajar","alarmed","alarming","alert","alienated","alive","all","altruistic","amazing","ambitious","ample","amused","amusing","anchored","ancient","angelic","angry","anguished","animated","annual","another","antique","anxious","any","apprehensive","appropriate","apt","arctic","arid","aromatic","artistic","ashamed","assured","astonishing","athletic","attached","attentive","attractive","austere","authentic","authorized","automatic","avaricious","average","aware","awesome","awful","awkward","babyish","bad","back","baggy","bare","barren","basic","beautiful","belated","beloved","beneficial","better","best","bewitched","big","big-hearted","biodegradable","bite-sized","bitter","black","black-and-white","bland","blank","blaring","bleak","blind","blissful","blond","blue","blushing","bogus","boiling","bold","bony","boring","bossy","both","bouncy","bountiful","bowed","brave","breakable","brief","bright","brilliant","brisk","broken","bronze","brown","bruised","bubbly","bulky","bumpy","buoyant","burdensome","burly","bustling","busy","buttery","buzzing","calculating","calm","candid","canine","capital","carefree","careful","careless","caring","cautious","cavernous","celebrated","charming","cheap","cheerful","cheery","chief","chilly","chubby","circular","classic","clean","clear","clear-cut","clever","close","closed","cloudy","clueless","clumsy","cluttered","coarse","cold","colorful","colorless","colossal","comfortable","common","compassionate","competent","complete","complex","complicated","composed","concerned","concrete","confused","conscious","considerate","constant","content","conventional","cooked","cool","cooperative","coordinated","corny","corrupt","costly","courageous","courteous","crafty","crazy","creamy","creative","creepy","criminal","crisp","critical","crooked","crowded","cruel","crushing","cuddly","cultivated","cultured","cumbersome","curly","curvy","cute","cylindrical","damaged","damp","dangerous","dapper","daring","darling","dark","dazzling","dead","deadly","deafening","dear","dearest","decent","decimal","decisive","deep","defenseless","defensive","defiant","deficient","definite","definitive","delayed","delectable","delicious","delightful","delirious","demanding","dense","dental","dependable","dependent","descriptive","deserted","detailed","determined","devoted","different","difficult","digital","diligent","dim","dimpled","dimwitted","direct","discrete","distant","downright","dreary","dirty","disguised","dishonest","dismal","distant","distinct","distorted","dizzy","dopey","doting","double","downright","drab","drafty","dramatic","droopy","dry","dual","dutiful","each","eager","earnest","early","easy","easy-going","ecstatic","edible","educated","elaborate","elastic","elated","elderly","electric","elegant","elementary","elliptical","embarrassed","embellished","eminent","emotional","empty","enchanted","enchanting","energetic","enlightened","enormous","enraged","entire","envious","equal","equatorial","essential","esteemed","ethical","euphoric","even","evergreen","everlasting","every","evil","exalted","excellent","exemplary","exhausted","excitable","excited","exciting","exotic","expensive","experienced","expert","extraneous","extroverted","extra-large","extra-small","fabulous","failing","faint","fair","faithful","fake","false","familiar","famous","fancy","fantastic","far","faraway","far-flung","far-off","fast","fat","fatal","fatherly","favorable","favorite","fearful","fearless","feisty","feline","female","feminine","few","fickle","filthy","fine","finished","firm","first","firsthand","fitting","fixed","flaky","flamboyant","flashy","flat","flawed","flawless","flickering","flimsy","flippant","flowery","fluffy","fluid","flustered","focused","fond","foolhardy","foolish","forceful","forked","formal","forsaken","forthright","fortunate","fragrant","frail","frank","frayed","free","French","fresh","frequent","friendly","frightened","frightening","frigid","frilly","frizzy","frivolous","front","frosty","frozen","frugal","fruitful","full","fumbling","functional","funny","fussy","fuzzy","gargantuan","gaseous","general","generous","gentle","genuine","giant","giddy","gigantic","gifted","giving","glamorous","glaring","glass","gleaming","gleeful","glistening","glittering","gloomy","glorious","glossy","glum","golden","good","good-natured","gorgeous","graceful","gracious","grand","grandiose","granular","grateful","gray","great","green","gregarious","gripping","grizzled","grouchy","grounded","growing","growling","grown","grubby","gruesome","grumpy","guilty","gullible","gummy","hairy","half","handmade","handsome","handy","happy","happy-go-lucky","hard","hard-to-find","harmful","harmless","harmonious","harsh","hasty","hateful","haunting","healthy","heartfelt","hearty","heavenly","heavy","hefty","helpful","helpless","hidden","hideous","high","high-level","hilarious","hoarse","hollow","homely","honest","honorable","honored","hopeful","horrible","hospitable","hot","huge","humble","humiliating","humming","humongous","hungry","hurtful","husky","icky","icy","ideal","idealistic","identical","idle","idiotic","idolized","ignorant","ill","illegal","ill-fated","ill-informed","illiterate","illustrious","imaginary","imaginative","immaculate","immaterial","immediate","immense","impassioned","impeccable","impartial","imperfect","imperturbable","impish","impolite","important","impossible","impractical","impressionable","impressive","improbable","impure","inborn","incomparable","incompatible","incomplete","inconsequential","incredible","indelible","inexperienced","indolent","infamous","infantile","infatuated","inferior","infinite","informal","innocent","insistent","instructive","insubstantial","intelligent","intent","intentional","interesting","internal","international","intrepid","ironclad","itchy","jaded","jagged","jam-packed","jaunty","jealous","jittery","joint","jolly","jovial","joyful","joyous","jubilant","judicious","juicy","jumbo","junior","jumpy","juvenile","kaleidoscopic","keen","key","kind","kindhearted","kindly","klutzy","knobby","knotty","knowledgeable","knowing","known","kooky","kosher","lanky","large","last","lasting","late","lavish","lawful","lazy","leading","lean","leafy","left","legal","legitimate","light","lighthearted","likable","likely","limited","limp","limping","linear","lined","liquid","little","live","lively","livid","lone","lonely","long","long-term","loose","lopsided","lost","loud","lovable","lovely","loving","low","loyal","lucky","lumbering","luminous","lumpy","lustrous","luxurious","mad","made-up","magnificent","majestic","major","male","mammoth","married","marvelous","masculine","massive","mature","meager","mealy","mean","measly","meaty","medical","mediocre","medium","meek","mellow","melodic","memorable","menacing","merry","messy","metallic","mild","milky","mindless","miniature","minor","minty","miserable","miserly","misguided","misty","mixed","modern","modest","moist","monstrous","monthly","monumental","moral","mortified","motherly","motionless","mountainous","muddy","muffled","multicolored","mundane","murky","mushy","muted","mysterious","naive","narrow","nasty","natural","naughty","nautical","near","neat","necessary","negligible","neighboring","nervous","new","next","nice","nifty","nimble","nippy","nocturnal","noisy","nonstop","normal","notable","noted","noteworthy","novel","numb","nutritious","nutty","obedient","oblong","oily","oblong","obvious","occasional","odd","oddball","offbeat","offensive","official","old","old-fashioned","only","open","optimal","optimistic","opulent","orange","orderly","organic","ornate","ornery","ordinary","original","other","our","outlying","outgoing","outlandish","outrageous","outstanding","oval","overcooked","overdue","overjoyed","overlooked","palatable","pale","paltry","parallel","parched","partial","passionate","past","pastel","peaceful","peppery","perfect","perfumed","periodic","perky","personal","pertinent","pesky","pessimistic","petty","phony","physical","piercing","pink","pitiful","plain","plaintive","plastic","playful","pleasant","pleased","pleasing","plump","plush","polished","polite","political","pointed","pointless","poised","poor","popular","portly","posh","positive","possible","potable","powerful","powerless","practical","precious","present","prestigious","pretty","precious","previous","pricey","prickly","primary","prime","pristine","private","prize","probable","productive","profitable","profuse","proper","proud","prudent","punctual","pungent","puny","pure","purple","pushy","puzzled","puzzling","quaint","qualified","quarrelsome","quarterly","queasy","querulous","questionable","quick","quick-witted","quiet","quintessential","quirky","quixotic","quizzical","radiant","ragged","rapid","rare","rash","raw","recent","reckless","rectangular","ready","real","realistic","reasonable","red","reflecting","regal","regular","reliable","relieved","remarkable","remorseful","remote","repentant","required","respectful","responsible","repulsive","revolving","rewarding","rich","rigid","right","ringed","ripe","roasted","robust","rosy","rotating","rotten","rough","round","rowdy","royal","rubbery","rundown","ruddy","runny","rural","rusty","sad","safe","salty","same","sandy","sane","sarcastic","sardonic","satisfied","scaly","scarce","scared","scary","scented","scholarly","scientific","scratchy","scrawny","second","secondary","second-hand","secret","self-assured","self-reliant","selfish","sentimental","separate","serene","serious","serpentine","several","severe","shabby","shadowy","shady","shallow","shameful","shameless","sharp","shimmering","shiny","shocked","shocking","shoddy","short","short-term","showy","shrill","shy","sick","silent","silky","silly","silver","similar","simple","simplistic","sinful","single","sizzling","skeletal","skinny","sleepy","slight","slim","slimy","slippery","slow","slushy","small","smart","smoggy","smooth","smug","snappy","snarling","sneaky","sniveling","snoopy","sociable","soft","soggy","solid","somber","some","spherical","sophisticated","sore","sorrowful","soulful","soupy","sour","Spanish","sparkling","sparse","specific","spectacular","speedy","spicy","spiffy","spirited","spiteful","splendid","spotless","spotted","spry","square","squeaky","squiggly","stable","staid","stained","stale","standard","starchy","stark","starry","steep","sticky","stiff","stimulating","stingy","stormy","straight","strange","steel","strict","strident","striking","striped","strong","studious","stunning","stupendous","sturdy","stylish","subdued","submissive","substantial","subtle","suburban","sudden","sugary","sunny","super","superb","superficial","superior","supportive","sure-footed","surprised","suspicious","svelte","sweet","sweltering","swift","sympathetic","tall","talkative","tame","tan","tangible","tart","tasty","tattered","taut","tedious","teeming","tempting","tender","tense","tepid","terrible","terrific","testy","thankful","that","these","thick","thin","third","thirsty","this","thorough","thorny","those","thoughtful","threadbare","thrifty","thunderous","tidy","tight","timely","tinted","tiny","tired","torn","total","tough","traumatic","treasured","tremendous","tragic","trained","tremendous","triangular","tricky","trifling","trim","trivial","troubled","true","trusting","trustworthy","trusty","truthful","tubby","turbulent","twin","ugly","ultimate","unacceptable","unaware","uncomfortable","uncommon","unconscious","understated","unequaled","uneven","unfinished","unfit","unfolded","unfortunate","unhappy","unhealthy","uniform","unimportant","unique","united","unkempt","unknown","unlawful","unlined","unlucky","unnatural","unpleasant","unrealistic","unripe","unruly","unselfish","unsightly","unsteady","unsung","untidy","untimely","untried","untrue","unused","unusual","unwelcome","unwieldy","unwilling","unwitting","unwritten","upbeat","upright","upset","urban","usable","used","useful","useless","utilized","utter","vacant","vague","vain","valid","valuable","vapid","variable","vast","velvety","venerated","vengeful","verifiable","vibrant","vicious","victorious","vigilant","vigorous","villainous","violet","violent","virtual","virtuous","visible","vital","vivacious","vivid","voluminous","wan","warlike","warm","warmhearted","warped","wary","wasteful","watchful","waterlogged","watery","wavy","wealthy","weak","weary","webbed","wee","weekly","weepy","weighty","weird","welcome","well-documented","well-groomed","well-informed","well-lit","well-made","well-off","well-to-do","well-worn","wet","which","whimsical","whirlwind","whispered","white","whole","whopping","wicked","wide","wide-eyed","wiggly","wild","willing","wilted","winding","windy","winged","wiry","wise","witty","wobbly","woeful","wonderful","wooden","woozy","wordy","worldly","worn","worried","worrisome","worse","worst","worthless","worthwhile","worthy","wrathful","wretched","writhing","wrong","wry","yawning","yearly","yellow","yellowish","young","youthful","yummy","zany","zealous","zesty","zigzag","rocky"],aa=["people","history","way","art","world","information","map","family","government","health","system","computer","meat","year","thanks","music","person","reading","method","data","food","understanding","theory","law","bird","literature","problem","software","control","knowledge","power","ability","economics","love","internet","television","science","library","nature","fact","product","idea","temperature","investment","area","society","activity","story","industry","media","thing","oven","community","definition","safety","quality","development","language","management","player","variety","video","week","security","country","exam","movie","organization","equipment","physics","analysis","policy","series","thought","basis","boyfriend","direction","strategy","technology","army","camera","freedom","paper","environment","child","instance","month","truth","marketing","university","writing","article","department","difference","goal","news","audience","fishing","growth","income","marriage","user","combination","failure","meaning","medicine","philosophy","teacher","communication","night","chemistry","disease","disk","energy","nation","road","role","soup","advertising","location","success","addition","apartment","education","math","moment","painting","politics","attention","decision","event","property","shopping","student","wood","competition","distribution","entertainment","office","population","president","unit","category","cigarette","context","introduction","opportunity","performance","driver","flight","length","magazine","newspaper","relationship","teaching","cell","dealer","debate","finding","lake","member","message","phone","scene","appearance","association","concept","customer","death","discussion","housing","inflation","insurance","mood","woman","advice","blood","effort","expression","importance","opinion","payment","reality","responsibility","situation","skill","statement","wealth","application","city","county","depth","estate","foundation","grandmother","heart","perspective","photo","recipe","studio","topic","collection","depression","imagination","passion","percentage","resource","setting","ad","agency","college","connection","criticism","debt","description","memory","patience","secretary","solution","administration","aspect","attitude","director","personality","psychology","recommendation","response","selection","storage","version","alcohol","argument","complaint","contract","emphasis","highway","loss","membership","possession","preparation","steak","union","agreement","cancer","currency","employment","engineering","entry","interaction","limit","mixture","preference","region","republic","seat","tradition","virus","actor","classroom","delivery","device","difficulty","drama","election","engine","football","guidance","hotel","match","owner","priority","protection","suggestion","tension","variation","anxiety","atmosphere","awareness","bread","climate","comparison","confusion","construction","elevator","emotion","employee","employer","guest","height","leadership","mall","manager","operation","recording","respect","sample","transportation","boring","charity","cousin","disaster","editor","efficiency","excitement","extent","feedback","guitar","homework","leader","mom","outcome","permission","presentation","promotion","reflection","refrigerator","resolution","revenue","session","singer","tennis","basket","bonus","cabinet","childhood","church","clothes","coffee","dinner","drawing","hair","hearing","initiative","judgment","lab","measurement","mode","mud","orange","poetry","police","possibility","procedure","queen","ratio","relation","restaurant","satisfaction","sector","signature","significance","song","tooth","town","vehicle","volume","wife","accident","airport","appointment","arrival","assumption","baseball","chapter","committee","conversation","database","enthusiasm","error","explanation","farmer","gate","girl","hall","historian","hospital","injury","instruction","maintenance","manufacturer","meal","perception","pie","poem","presence","proposal","reception","replacement","revolution","river","son","speech","tea","village","warning","winner","worker","writer","assistance","breath","buyer","chest","chocolate","conclusion","contribution","cookie","courage","desk","drawer","establishment","examination","garbage","grocery","honey","impression","improvement","independence","insect","inspection","inspector","king","ladder","menu","penalty","piano","potato","profession","professor","quantity","reaction","requirement","salad","sister","supermarket","tongue","weakness","wedding","affair","ambition","analyst","apple","assignment","assistant","bathroom","bedroom","beer","birthday","celebration","championship","cheek","client","consequence","departure","diamond","dirt","ear","fortune","friendship","funeral","gene","girlfriend","hat","indication","intention","lady","midnight","negotiation","obligation","passenger","pizza","platform","poet","pollution","recognition","reputation","shirt","speaker","stranger","surgery","sympathy","tale","throat","trainer","uncle","youth","time","work","film","water","money","example","while","business","study","game","life","form","air","day","place","number","part","field","fish","back","process","heat","hand","experience","job","book","end","point","type","home","economy","value","body","market","guide","interest","state","radio","course","company","price","size","card","list","mind","trade","line","care","group","risk","word","fat","force","key","light","training","name","school","top","amount","level","order","practice","research","sense","service","piece","web","boss","sport","fun","house","page","term","test","answer","sound","focus","matter","kind","soil","board","oil","picture","access","garden","range","rate","reason","future","site","demand","exercise","image","case","cause","coast","action","age","bad","boat","record","result","section","building","mouse","cash","class","period","plan","store","tax","side","subject","space","rule","stock","weather","chance","figure","man","model","source","beginning","earth","program","chicken","design","feature","head","material","purpose","question","rock","salt","act","birth","car","dog","object","scale","sun","note","profit","rent","speed","style","war","bank","craft","half","inside","outside","standard","bus","exchange","eye","fire","position","pressure","stress","advantage","benefit","box","frame","issue","step","cycle","face","item","metal","paint","review","room","screen","structure","view","account","ball","discipline","medium","share","balance","bit","black","bottom","choice","gift","impact","machine","shape","tool","wind","address","average","career","culture","morning","pot","sign","table","task","condition","contact","credit","egg","hope","ice","network","north","square","attempt","date","effect","link","post","star","voice","capital","challenge","friend","self","shot","brush","couple","exit","front","function","lack","living","plant","plastic","spot","summer","taste","theme","track","wing","brain","button","click","desire","foot","gas","influence","notice","rain","wall","base","damage","distance","feeling","pair","savings","staff","sugar","target","text","animal","author","budget","discount","file","ground","lesson","minute","officer","phase","reference","register","sky","stage","stick","title","trouble","bowl","bridge","campaign","character","club","edge","evidence","fan","letter","lock","maximum","novel","option","pack","park","quarter","skin","sort","weight","baby","background","carry","dish","factor","fruit","glass","joint","master","muscle","red","strength","traffic","trip","vegetable","appeal","chart","gear","ideal","librarychen","land","log","mother","net","party","principle","relative","sale","season","signal","spirit","street","tree","wave","belt","bench","commission","copy","drop","minimum","path","progress","project","sea","south","status","stuff","ticket","tour","angle","blue","breakfast","confidence","daughter","degree","doctor","dot","dream","duty","essay","father","fee","finance","hour","juice","luck","milk","mouth","peace","pipe","stable","storm","substance","team","trick","afternoon","bat","beach","blank","catch","chain","consideration","cream","crew","detail","gold","interview","kid","mark","mission","pain","pleasure","score","screw","sex","shop","shower","suit","tone","window","agent","band","bath","block","bone","calendar","candidate","cap","coat","contest","corner","court","cup","district","door","east","finger","garage","guarantee","hole","hook","implement","layer","lecture","lie","manner","meeting","nose","parking","partner","profile","rice","routine","schedule","swimming","telephone","tip","winter","airline","bag","battle","bed","bill","bother","cake","code","curve","designer","dimension","dress","ease","emergency","evening","extension","farm","fight","gap","grade","holiday","horror","horse","host","husband","loan","mistake","mountain","nail","noise","occasion","package","patient","pause","phrase","proof","race","relief","sand","sentence","shoulder","smoke","stomach","string","tourist","towel","vacation","west","wheel","wine","arm","aside","associate","bet","blow","border","branch","breast","brother","buddy","bunch","chip","coach","cross","document","draft","dust","expert","floor","god","golf","habit","iron","judge","knife","landscape","league","mail","mess","native","opening","parent","pattern","pin","pool","pound","request","salary","shame","shelter","shoe","silver","tackle","tank","trust","assist","bake","bar","bell","bike","blame","boy","brick","chair","closet","clue","collar","comment","conference","devil","diet","fear","fuel","glove","jacket","lunch","monitor","mortgage","nurse","pace","panic","peak","plane","reward","row","sandwich","shock","spite","spray","surprise","till","transition","weekend","welcome","yard","alarm","bend","bicycle","bite","blind","bottle","cable","candle","clerk","cloud","concert","counter","flower","grandfather","harm","knee","lawyer","leather","load","mirror","neck","pension","plate","purple","ruin","ship","skirt","slice","snow","specialist","stroke","switch","trash","tune","zone","anger","award","bid","bitter","boot","bug","camp","candy","carpet","cat","champion","channel","clock","comfort","cow","crack","engineer","entrance","fault","grass","guy","hell","highlight","incident","island","joke","jury","leg","lip","mate","motor","nerve","passage","pen","pride","priest","prize","promise","resident","resort","ring","roof","rope","sail","scheme","script","sock","station","toe","tower","truck","witness","can","will","other","use","make","good","look","help","go","great","being","still","public","read","keep","start","give","human","local","general","specific","long","play","feel","high","put","common","set","change","simple","past","big","possible","particular","major","personal","current","national","cut","natural","physical","show","try","check","second","call","move","pay","let","increase","single","individual","turn","ask","buy","guard","hold","main","offer","potential","professional","international","travel","cook","alternative","special","working","whole","dance","excuse","cold","commercial","low","purchase","deal","primary","worth","fall","necessary","positive","produce","search","present","spend","talk","creative","tell","cost","drive","green","support","glad","remove","return","run","complex","due","effective","middle","regular","reserve","independent","leave","original","reach","rest","serve","watch","beautiful","charge","active","break","negative","safe","stay","visit","visual","affect","cover","report","rise","walk","white","junior","pick","unique","classic","final","lift","mix","private","stop","teach","western","concern","familiar","fly","official","broad","comfortable","gain","rich","save","stand","young","heavy","lead","listen","valuable","worry","handle","leading","meet","release","sell","finish","normal","press","ride","secret","spread","spring","tough","wait","brown","deep","display","flow","hit","objective","shoot","touch","cancel","chemical","cry","dump","extreme","push","conflict","eat","fill","formal","jump","kick","opposite","pass","pitch","remote","total","treat","vast","abuse","beat","burn","deposit","print","raise","sleep","somewhere","advance","consist","dark","double","draw","equal","fix","hire","internal","join","sensitive","tap","win","attack","claim","constant","drag","drink","guess","minor","pull","raw","soft","solid","wear","weird","wonder","annual","count","dead","doubt","feed","forever","impress","repeat","round","sing","slide","strip","wish","combine","command","dig","divide","equivalent","hang","hunt","initial","march","mention","spiritual","survey","tie","adult","brief","crazy","escape","gather","hate","prior","repair","rough","sad","scratch","sick","strike","employ","external","hurt","illegal","laugh","lay","mobile","nasty","ordinary","respond","royal","senior","split","strain","struggle","swim","train","upper","wash","yellow","convert","crash","dependent","fold","funny","grab","hide","miss","permit","quote","recover","resolve","roll","sink","slip","spare","suspect","sweet","swing","twist","upstairs","usual","abroad","brave","calm","concentrate","estimate","grand","male","mine","prompt","quiet","refuse","regret","reveal","rush","shake","shift","shine","steal","suck","surround","bear","brilliant","dare","dear","delay","drunk","female","hurry","inevitable","invite","kiss","neat","pop","punch","quit","reply","representative","resist","rip","rub","silly","smile","spell","stretch","tear","temporary","tomorrow","wake","wrap","yesterday"],sa=(t,e,o)=>{if(t&&clearTimeout(t),e&&o)return setTimeout(e,o)},na=t=>async(...e)=>{await Promise.resolve(),t(...e)},ia=(t,e)=>{setTimeout(t,e??0)},{logFactory:Ae,Paths:Le}=ht,la=import.meta.url.split("/").slice(0,-1).join("/");Le.setRoot(la);globalThis.Core=bt;var{config:qe}=globalThis;globalThis.config={...qe};if(qe&&globalThis?.document){let t=import.meta.url.split("/").slice(0,-1).join("/"),e=document.URL;e[e.length-1]!=="/"&&(e=e.split("/").slice(0,-1).join("/"));let o=new URL(t,e).href;o[o.length-1]==="/"&&(o=o.slice(0,-1)),qe.paths={...qe.paths,$core:o}}(()=>{let t=[({imports:i,liveVar:p,onceVar:a})=>{i([]);let d=globalThis;a.universalThis(d);let{Array:h,Date:c,FinalizationRegistry:r,Float32Array:v,JSON:s,Map:m,Math:w,Number:O,Object:S,Promise:g,Proxy:j,Reflect:b,RegExp:u,Set:k,String:f,WeakMap:E,WeakSet:I}=globalThis;a.Array(h),a.Date(c),a.FinalizationRegistry(r),a.Float32Array(v),a.JSON(s),a.Map(m),a.Math(w),a.Number(O),a.Object(S),a.Promise(g),a.Proxy(j),a.Reflect(b),a.FERAL_REG_EXP(u),a.Set(k),a.String(f),a.WeakMap(E),a.WeakSet(I);let{Error:y,RangeError:D,ReferenceError:L,SyntaxError:T,TypeError:x}=globalThis;a.FERAL_ERROR(y),a.RangeError(D),a.ReferenceError(L),a.SyntaxError(T),a.TypeError(x);let{assign:F,create:P,defineProperties:_,entries:N,freeze:G,getOwnPropertyDescriptor:H,getOwnPropertyDescriptors:V,getOwnPropertyNames:C,getPrototypeOf:Y,is:W,isExtensible:U,keys:A,prototype:z,seal:J,preventExtensions:B,setPrototypeOf:K,values:M}=S;a.assign(F),a.create(P),a.defineProperties(_),a.entries(N),a.freeze(G),a.getOwnPropertyDescriptor(H),a.getOwnPropertyDescriptors(V),a.getOwnPropertyNames(C),a.getPrototypeOf(Y),a.is(W),a.isExtensible(U),a.keys(A),a.objectPrototype(z),a.seal(J),a.preventExtensions(B),a.setPrototypeOf(K),a.values(M);let{species:Q,toStringTag:R,iterator:q,matchAll:$,keyFor:Z,for:ee}=Symbol;a.speciesSymbol(Q),a.toStringTagSymbol(R),a.iteratorSymbol(q),a.matchAllSymbol($),a.symbolKeyFor(Z),a.symbolFor(ee);let{isInteger:ie}=O;a.isInteger(ie);let{stringify:ae}=s;a.stringifyJson(ae);let se=S.fromEntries||(ye=>{let xe={};for(let[Re,Ge]of ye)xe[Re]=Ge;return xe});a.fromEntries(se);let{defineProperty:te}=S;a.defineProperty((ye,xe,Re)=>{let Ge=te(ye,xe,Re);if(Ge!==ye)throw x(`Please report that the original defineProperty silently failed to set ${ae(f(xe))}. (SES_DEFINE_PROPERTY_FAILED_SILENTLY)`);return Ge});let{apply:re,construct:oe,get:le,getOwnPropertyDescriptor:me,has:pe,isExtensible:ue,ownKeys:he,preventExtensions:ce,set:be}=b;a.apply(re),a.construct(oe),a.reflectGet(le),a.reflectGetOwnPropertyDescriptor(me),a.reflectHas(pe),a.reflectIsExtensible(ue),a.ownKeys(he),a.reflectPreventExtensions(ce),a.reflectSet(be);let{isArray:ve,prototype:ge}=h;a.isArray(ve),a.arrayPrototype(ge);let{prototype:we}=m;a.mapPrototype(we);let{revocable:Ee}=j;a.proxyRevocable(Ee);let{prototype:ke}=RegExp;a.regexpPrototype(ke);let{prototype:Se}=k;a.setPrototype(Se);let{prototype:de}=f;a.stringPrototype(de);let{prototype:fe}=E;a.weakmapPrototype(fe);let{prototype:Fe}=I;a.weaksetPrototype(Fe);let{prototype:Pt}=Function;a.functionPrototype(Pt);let{prototype:Ke}=g;a.promisePrototype(Ke);let nr=Y(Uint8Array.prototype);a.typedArrayPrototype(nr);let X=ye=>(xe,...Re)=>re(ye,xe,Re);a.uncurryThis(X);let ir=X(z.hasOwnProperty);a.objectHasOwnProperty(ir);let lr=X(ge.filter);a.arrayFilter(lr);let cr=X(ge.forEach);a.arrayForEach(cr);let pr=X(ge.includes);a.arrayIncludes(pr);let ur=X(ge.join);a.arrayJoin(ur);let mr=X(ge.map);a.arrayMap(mr);let dr=X(ge.pop);a.arrayPop(dr);let yr=X(ge.push);a.arrayPush(yr);let gr=X(ge.slice);a.arraySlice(gr);let fr=X(ge.some);a.arraySome(fr);let hr=X(ge.sort);a.arraySort(hr);let br=X(ge[q]);a.iterateArray(br);let vr=X(we.set);a.mapSet(vr);let wr=X(we.get);a.mapGet(wr);let Pr=X(we.has);a.mapHas(Pr);let Er=X(we.delete);a.mapDelete(Er);let Sr=X(we.entries);a.mapEntries(Sr);let kr=X(we[q]);a.iterateMap(kr);let xr=X(Se.add);a.setAdd(xr);let jr=X(Se.delete);a.setDelete(jr);let Tr=X(Se.forEach);a.setForEach(Tr);let Ar=X(Se.has);a.setHas(Ar);let Or=X(Se[q]);a.iterateSet(Or);let Ir=X(ke.test);a.regexpTest(Ir);let Cr=X(ke.exec);a.regexpExec(Cr);let Fr=X(ke[$]);a.matchAllRegExp(Fr);let Rr=X(de.endsWith);a.stringEndsWith(Rr);let Nr=X(de.includes);a.stringIncludes(Nr);let Mr=X(de.indexOf);a.stringIndexOf(Mr);let _r=X(de.match);a.stringMatch(_r);let Dr=X(de.replace);a.stringReplace(Dr);let Lr=X(de.search);a.stringSearch(Lr);let Vr=X(de.slice);a.stringSlice(Vr);let Gr=X(de.split);a.stringSplit(Gr);let Hr=X(de.startsWith);a.stringStartsWith(Hr);let Ur=X(de[q]);a.iterateString(Ur);let zr=X(fe.delete);a.weakmapDelete(zr);let $r=X(fe.get);a.weakmapGet($r);let Wr=X(fe.has);a.weakmapHas(Wr);let qr=X(fe.set);a.weakmapSet(qr);let Br=X(Fe.add);a.weaksetAdd(Br);let Kr=X(Fe.get);a.weaksetGet(Kr);let Jr=X(Fe.has);a.weaksetHas(Jr);let Yr=X(Pt.toString);a.functionToString(Yr);let{all:Xr}=g;a.promiseAll(ye=>re(Xr,g,[ye]));let Zr=X(Ke.catch);a.promiseCatch(Zr);let Qr=X(Ke.then);a.promiseThen(Qr);let eo=r&&X(r.prototype.register);a.finalizationRegistryRegister(eo);let to=r&&X(r.prototype.unregister);a.finalizationRegistryUnregister(to),a.getConstructorOf(ye=>le(Y(ye),"constructor"));let ro=G(P(null));a.immutableObject(ro),a.isObject(ye=>S(ye)===ye),a.isError(ye=>ye instanceof y);let oo=eval;a.FERAL_EVAL(oo);let ao=Function;a.FERAL_FUNCTION(ao),a.noEvalEvaluate(()=>{throw new x('Cannot eval with evalTaming set to "noEval" (SES_NO_EVAL)')})},({imports:i,liveVar:p,onceVar:a})=>{i([])},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s,m,w,O,S,g,j,b;i([["../commons.js",[["Set",[f=>d=f]],["String",[f=>h=f]],["arrayJoin",[f=>c=f]],["arraySlice",[f=>r=f]],["freeze",[f=>v=f]],["is",[f=>s=f]],["isError",[f=>m=f]],["setAdd",[f=>w=f]],["setHas",[f=>O=f]],["stringIncludes",[f=>S=f]],["stringStartsWith",[f=>g=f]],["stringifyJson",[f=>j=f]],["toStringTagSymbol",[f=>b=f]]]]]),a.enJoin((f,E)=>{if(f.length===0)return"(none)";if(f.length===1)return f[0];if(f.length===2){let[I,y]=f;return`${I} ${E} ${y}`}return`${c(r(f,0,-1),", ")}, ${E} ${f[f.length-1]}`});let u=f=>(f=""+f).length>=1&&S("aeiouAEIOU",f[0])?"an "+f:"a "+f;a.an(u),v(u);let k=(f,E)=>{let I=new d,y=(D,L)=>{switch(typeof L){case"object":return L===null?null:O(I,L)?"[Seen]":(w(I,L),m(L)?`[${L.name}: ${L.message}]`:b in L?`[${L[b]}]`:L);case"function":return`[Function ${L.name||"<anon>"}]`;case"string":return g(L,"[")?`[${L}]`:L;case"undefined":case"symbol":return`[${h(L)}]`;case"bigint":return`[${L}n]`;case"number":return s(L,NaN)?"[NaN]":L===1/0?"[Infinity]":L===-1/0?"[-Infinity]":L;default:return L}};try{return j(f,y,E)}catch{return"[Something that failed to stringify]"}};a.bestEffortStringify(k),v(k)},({imports:i,liveVar:p,onceVar:a})=>{i([])},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s,m,w,O,S,g,j,b,u,k,f,E,I,y,D,L,T;i([["../commons.js",[["RangeError",[R=>d=R]],["TypeError",[R=>h=R]],["WeakMap",[R=>c=R]],["arrayJoin",[R=>r=R]],["arrayMap",[R=>v=R]],["arrayPop",[R=>s=R]],["arrayPush",[R=>m=R]],["assign",[R=>w=R]],["freeze",[R=>O=R]],["globalThis",[R=>S=R]],["is",[R=>g=R]],["isError",[R=>j=R]],["stringIndexOf",[R=>b=R]],["stringReplace",[R=>u=R]],["stringSlice",[R=>k=R]],["stringStartsWith",[R=>f=R]],["weakmapDelete",[R=>E=R]],["weakmapGet",[R=>I=R]],["weakmapHas",[R=>y=R]],["weakmapSet",[R=>D=R]]]],["./stringify-utils.js",[["an",[R=>L=R]],["bestEffortStringify",[R=>T=R]]]],["./types.js",[]],["./internal-types.js",[]]]);let x=new c,F=(R,q)=>{let $=O({toString:O(()=>T(R,q))});return D(x,$,R),$};O(F);let P=new c,_=({template:R,args:q})=>{let $=[R[0]];for(let Z=0;Z<q.length;Z+=1){let ee=q[Z],ie;ie=y(x,ee)?""+ee:j(ee)?`(${L(ee.name)})`:`(${L(typeof ee)})`,m($,ie,R[Z+1])}return r($,"")},N=O({toString(){let R=I(P,this);return R===void 0?"[Not a DetailsToken]":_(R)}});O(N.toString);let G=(R,...q)=>{let $=O({__proto__:N});return D(P,$,{template:R,args:q}),$};O(G);let H=(R,...q)=>(q=v(q,$=>y(x,$)?$:F($)),G(R,...q));a.unredactedDetails(H),O(H);let V=({template:R,args:q})=>{let $=[R[0]];for(let Z=0;Z<q.length;Z+=1){let ee=q[Z];y(x,ee)&&(ee=I(x,ee));let ie=u(s($)||"",/ $/,"");ie!==""&&m($,ie);let ae=u(R[Z+1],/^ /,"");m($,ee,ae)}return $[$.length-1]===""&&s($),$},C=new c,Y=0,W=new c,U=(R,q=R.name)=>{let $=I(W,R);return $!==void 0||(Y+=1,$=`${q}#${Y}`,D(W,R,$)),$},A=(R=G`Assert failed`,q=S.Error,{errorName:$}={})=>{typeof R=="string"&&(R=G([R]));let Z=I(P,R);if(Z===void 0)throw new h("unrecognized details "+F(R));let ee=new q(_(Z));return D(C,ee,V(Z)),$!==void 0&&U(ee,$),ee};O(A);let z=new c,J=new c,B=(R,q)=>{typeof q=="string"&&(q=G([q]));let $=I(P,q);if($===void 0)throw new h("unrecognized details "+F(q));let Z=V($),ee=I(J,R);if(ee!==void 0)for(let ie of ee)ie(R,Z);else{let ie=I(z,R);ie!==void 0?m(ie,Z):D(z,R,[Z])}};O(B);let K={getStackString:S.getStackString||(R=>{if(!("stack"in R))return"";let q=""+R.stack,$=b(q,`
`);return f(q," ")||$===-1?q:k(q,$+1)}),tagError:R=>U(R),resetErrorTagNum:()=>{Y=0},getMessageLogArgs:R=>I(C,R),takeMessageLogArgs:R=>{let q=I(C,R);return E(C,R),q},takeNoteLogArgsArray:(R,q)=>{let $=I(z,R);if(E(z,R),q!==void 0){let Z=I(J,R);Z?m(Z,q):D(J,R,[q])}return $||[]}};a.loggedErrorHandler(K),O(K);let M=(R,q=!1)=>{let $=q?H:G,Z=(te=$`Assert failed`,re=S.Error)=>{let oe=A(te,re);throw R!==void 0&&R(oe),oe};function ee(te,re=$`Check failed`,oe=S.Error){if(!te)throw Z(re,oe)}O(Z);let ie=(te,re,oe=$`Expected ${te} is same as ${re}`,le=d)=>{ee(g(te,re),oe,le)};O(ie);let ae=(te,re,oe)=>{ee(typeof re=="string",$`${F(re)} must be a string`),oe===void 0&&(oe=$([""," must be "+L(re)],te)),ie(typeof te,re,oe,h)};O(ae);let se=w(ee,{error:A,fail:Z,equal:ie,typeof:ae,string:(te,re)=>ae(te,"string",re),note:B,details:$,quote:F,makeAssert:M});return O(se)};a.makeAssert(M),O(M);let Q=M();a.assert(Q)},({imports:i,liveVar:p,onceVar:a})=>{let d,h;i([["./commons.js",[["FERAL_FUNCTION",[c=>d=c]],["arrayJoin",[c=>h=c]]]]]),a.makeEvaluateFactory((c=[])=>{let r=function(v){return v.length===0?"":`const {${h(v,",")}} = this;`}(c);return d(`
    with (this) {
      ${r}
      return function() {
        'use strict';
        return eval(arguments[0]);
      };
    }
  `)})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s;i([["./commons.js",[["arrayFilter",[g=>d=g]],["arrayIncludes",[g=>h=g]],["getOwnPropertyDescriptor",[g=>c=g]],["getOwnPropertyNames",[g=>r=g]],["objectHasOwnProperty",[g=>v=g]],["regexpTest",[g=>s=g]]]]]);let m=["await","break","case","catch","class","const","continue","debugger","default","delete","do","else","export","extends","finally","for","function","if","import","in","instanceof","new","return","super","switch","this","throw","try","typeof","var","void","while","with","yield","let","static","enum","implements","package","protected","interface","private","public","await","null","true","false","this","arguments"],w=/^[a-zA-Z_$][\w$]*$/,O=g=>g!=="eval"&&!h(m,g)&&s(w,g);function S(g,j){let b=c(g,j);return b.configurable===!1&&b.writable===!1&&v(b,"value")}a.isValidIdentifierName(O),a.getScopeConstants((g,j={})=>{let b=r(g),u=r(j),k=d(u,f=>O(f)&&S(j,f));return[...d(b,f=>!h(u,f)&&O(f)&&S(g,f)),...k]})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s,m,w,O,S,g,j,b,u,k;i([["./commons.js",[["FERAL_EVAL",[y=>d=y]],["Proxy",[y=>h=y]],["String",[y=>c=y]],["TypeError",[y=>r=y]],["create",[y=>v=y]],["freeze",[y=>s=y]],["getOwnPropertyDescriptor",[y=>m=y]],["getOwnPropertyDescriptors",[y=>w=y]],["globalThis",[y=>O=y]],["immutableObject",[y=>S=y]],["objectHasOwnProperty",[y=>g=y]],["reflectGet",[y=>j=y]],["reflectSet",[y=>b=y]],["seal",[y=>u=y]]]],["./error/assert.js",[["assert",[y=>k=y]]]]]);let{details:f,quote:E}=k,I=new h(S,s({get(y,D){k.fail(f`Please report unexpected scope handler trap: ${E(c(D))}`)}}));a.createScopeHandler((y,D={},{sloppyGlobalsMode:L=!1}={})=>{let T={allowNextEvalToBeUnsafe:!1};u(T);let x=s(v(I,w({get(F,P){if(typeof P!="symbol")return P==="eval"&&T.allowNextEvalToBeUnsafe===!0?(T.allowNextEvalToBeUnsafe=!1,d):P in D?j(D,P,y):j(y,P)},set(F,P,_){if(P in D){let N=m(D,P);return g(N,"value")?b(D,P,_):b(D,P,_,y)}return b(y,P,_)},has:(F,P)=>L||T.allowNextEvalToBeUnsafe&&P==="eval"||P in D||P in y||P in O,getPrototypeOf:()=>null,getOwnPropertyDescriptor(F,P){let _=E(c(P));console.warn("getOwnPropertyDescriptor trap on scopeHandler for "+_,new r().stack)}})));return{scopeController:T,scopeHandler:x}})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c;i([["./commons.js",[["FERAL_REG_EXP",[v=>d=v]],["regexpExec",[v=>h=v]],["stringSlice",[v=>c=v]]]]]);let r=new d("(?:\\s*//\\s*[@#]\\s*([a-zA-Z][a-zA-Z0-9]*)\\s*=\\s*([^\\s\\*]*)|/\\*\\s*[@#]\\s*([a-zA-Z][a-zA-Z0-9]*)\\s*=\\s*([^\\s\\*]*)\\s*\\*/)\\s*$");a.getSourceURL(v=>{let s="<unknown>";for(;v.length>0;){let m=h(r,v);if(m===null)break;v=c(v,0,v.length-m[0].length),m[3]==="sourceURL"?s=m[4]:m[1]==="sourceURL"&&(s=m[2])}return s})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s,m;function w(u,k){let f=r(u,k);if(f<0)return-1;let E=u[f]===`
`?1:0;return s(v(u,0,f),`
`).length+E}i([["./commons.js",[["FERAL_REG_EXP",[u=>d=u]],["SyntaxError",[u=>h=u]],["stringReplace",[u=>c=u]],["stringSearch",[u=>r=u]],["stringSlice",[u=>v=u]],["stringSplit",[u=>s=u]]]],["./get-source-url.js",[["getSourceURL",[u=>m=u]]]]]);let O=new d("(?:MATCHES_NOTHING_EVAR)","g"),S=u=>{let k=w(u,O);if(k<0)return u;let f=m(u);throw new h(`Possible HTML comment rejected at ${f}:${k}. (SES_HTML_COMMENT_REJECTED)`)};a.rejectHtmlComments(S),a.evadeHtmlCommentTest(u=>c(u,O,k=>k[0]==="<"?"< ! --":"-- >"));let g=new d("(^|[^.])\\bimport(\\s*(?:\\(|/[/*]))","g"),j=u=>{let k=w(u,g);if(k<0)return u;let f=m(u);throw new h(`Possible import expression rejected at ${f}:${k}. (SES_IMPORT_REJECTED)`)};a.rejectImportExpressions(j),a.evadeImportExpressionTest(u=>c(u,g,(k,f,E)=>`${f}__import__${E}`));let b=new d("(^|[^.])\\beval(\\s*\\()","g");a.rejectSomeDirectEvalExpressions(u=>{let k=w(u,b);if(k<0)return u;let f=m(u);throw new h(`Possible direct eval expression rejected at ${f}:${k}. (SES_EVAL_REJECTED)`)}),a.mandatoryTransforms(u=>(u=S(u),u=j(u))),a.applyTransforms((u,k)=>{for(let f of k)u=f(u);return u})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s,m,w,O,S,g;i([["./commons.js",[["WeakSet",[b=>d=b]],["apply",[b=>h=b]],["immutableObject",[b=>c=b]],["proxyRevocable",[b=>r=b]],["weaksetAdd",[b=>v=b]]]],["./scope-constants.js",[["getScopeConstants",[b=>s=b]]]],["./scope-handler.js",[["createScopeHandler",[b=>m=b]]]],["./transforms.js",[["applyTransforms",[b=>w=b]],["mandatoryTransforms",[b=>O=b]]]],["./make-evaluate-factory.js",[["makeEvaluateFactory",[b=>S=b]]]],["./error/assert.js",[["assert",[b=>g=b]]]]]);let{details:j}=g;a.makeSafeEvaluator(({globalObject:b,globalLexicals:u={},globalTransforms:k=[],sloppyGlobalsMode:f=!1,knownScopeProxies:E=new d}={})=>{let{scopeHandler:I,scopeController:y}=m(b,u,{sloppyGlobalsMode:f}),{proxy:D,revoke:L}=r(c,I),T;return v(E,D),{safeEvaluate:(x,{localTransforms:F=[]}={})=>{let P;(()=>{if(!T){let _=s(b,u),N=S(_);T=h(N,D,[])}})(),x=w(x,[...F,...k,O]),y.allowNextEvalToBeUnsafe=!0;try{return h(T,b,[x])}catch(_){throw P=_,_}finally{let _=y.allowNextEvalToBeUnsafe;y.allowNextEvalToBeUnsafe=!1,_&&(L(),g.fail(j`handler did not reset allowNextEvalToBeUnsafe ${P}`))}}}})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s,m,w,O;i([["./commons.js",[["TypeError",[g=>d=g]],["arrayPush",[g=>h=g]],["create",[g=>c=g]],["defineProperties",[g=>r=g]],["getOwnPropertyDescriptors",[g=>v=g]]]],["./transforms.js",[["evadeHtmlCommentTest",[g=>s=g]],["evadeImportExpressionTest",[g=>m=g]],["rejectSomeDirectEvalExpressions",[g=>w=g]]]],["./make-safe-evaluator.js",[["makeSafeEvaluator",[g=>O=g]]]]]);let S=(g,j)=>{let{sloppyGlobalsMode:b=!1,__moduleShimLexicals__:u}=j,k;if(u!==void 0||b){let{globalTransforms:f}=g,{globalObject:E,globalLexicals:I,knownScopeProxies:y}=g,D=I;u!==void 0&&(f=void 0,D=c(null,v(I)),r(D,v(u))),{safeEvaluate:k}=O({globalObject:E,globalLexicals:D,globalTransforms:f,sloppyGlobalsMode:b,knownScopeProxies:y})}else({safeEvaluate:k}=g);return{safeEvaluate:k}};a.provideCompartmentEvaluator(S),a.compartmentEvaluate((g,j,b)=>{if(typeof j!="string")throw new d("first argument of evaluate() must be a string");let{transforms:u=[],__evadeHtmlCommentTest__:k=!1,__evadeImportExpressionTest__:f=!1,__rejectSomeDirectEvalExpressions__:E=!0}=b,I=[...u];k===!0&&h(I,s),f===!0&&h(I,m),E===!0&&h(I,w);let{safeEvaluate:y}=S(g,b);return y(j,{localTransforms:I})})},({imports:i,liveVar:p,onceVar:a})=>{i([]),a.makeEvalFunction(d=>h=>typeof h!="string"?h:d(h))},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s;i([["./commons.js",[["FERAL_FUNCTION",[m=>d=m]],["arrayJoin",[m=>h=m]],["arrayPop",[m=>c=m]],["defineProperties",[m=>r=m]],["getPrototypeOf",[m=>v=m]]]],["./error/assert.js",[["assert",[m=>s=m]]]]]),a.makeFunctionConstructor(m=>{let w=function(O){let S=""+(c(arguments)||""),g=""+h(arguments,",");new d(g,""),new d(S);let j=`(function anonymous(${g}
) {
${S}
})`;return m(j)};return r(w,{prototype:{value:d.prototype,writable:!1,enumerable:!1,configurable:!1}}),s(v(d)===d.prototype,"Function prototype is the same accross compartments"),s(v(w)===d.prototype,"Function constructor prototype is the same accross compartments"),w})},({imports:i,liveVar:p,onceVar:a})=>{i([]);let d={Infinity:1/0,NaN:NaN,undefined:void 0};a.constantProperties(d),a.universalPropertyNames({isFinite:"isFinite",isNaN:"isNaN",parseFloat:"parseFloat",parseInt:"parseInt",decodeURI:"decodeURI",decodeURIComponent:"decodeURIComponent",encodeURI:"encodeURI",encodeURIComponent:"encodeURIComponent",Array:"Array",ArrayBuffer:"ArrayBuffer",BigInt:"BigInt",BigInt64Array:"BigInt64Array",BigUint64Array:"BigUint64Array",Boolean:"Boolean",DataView:"DataView",EvalError:"EvalError",Float32Array:"Float32Array",Float64Array:"Float64Array",Int8Array:"Int8Array",Int16Array:"Int16Array",Int32Array:"Int32Array",Map:"Map",Number:"Number",Object:"Object",Promise:"Promise",Proxy:"Proxy",RangeError:"RangeError",ReferenceError:"ReferenceError",Set:"Set",String:"String",Symbol:"Symbol",SyntaxError:"SyntaxError",TypeError:"TypeError",Uint8Array:"Uint8Array",Uint8ClampedArray:"Uint8ClampedArray",Uint16Array:"Uint16Array",Uint32Array:"Uint32Array",URIError:"URIError",WeakMap:"WeakMap",WeakSet:"WeakSet",JSON:"JSON",Reflect:"Reflect",escape:"escape",unescape:"unescape",lockdown:"lockdown",harden:"harden",HandledPromise:"HandledPromise"}),a.initialGlobalPropertyNames({Date:"%InitialDate%",Error:"%InitialError%",RegExp:"%InitialRegExp%",Math:"%InitialMath%",getStackString:"%InitialGetStackString%"}),a.sharedGlobalPropertyNames({Date:"%SharedDate%",Error:"%SharedError%",RegExp:"%SharedRegExp%",Math:"%SharedMath%"}),a.uniqueGlobalPropertyNames({globalThis:"%UniqueGlobalThis%",eval:"%UniqueEval%",Function:"%UniqueFunction%",Compartment:"%UniqueCompartment%"});let h=[EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError];a.NativeErrors(h);let c={"[[Proto]]":"%FunctionPrototype%",length:"number",name:"string"};a.FunctionInstance(c);let r=c,v={"[[Proto]]":"%AsyncFunctionPrototype%"},s={get:r,set:"undefined"},m={get:r,set:r};function w(u){return{"[[Proto]]":"%SharedError%",prototype:u}}function O(u){return{"[[Proto]]":"%ErrorPrototype%",constructor:u,message:"string",name:"string",toString:!1,cause:!1}}function S(u){return{"[[Proto]]":"%TypedArray%",BYTES_PER_ELEMENT:"number",prototype:u}}function g(u){return{"[[Proto]]":"%TypedArrayPrototype%",BYTES_PER_ELEMENT:"number",constructor:u}}a.isAccessorPermit(u=>u===s||u===m);let j={E:"number",LN10:"number",LN2:"number",LOG10E:"number",LOG2E:"number",PI:"number",SQRT1_2:"number",SQRT2:"number","@@toStringTag":"string",abs:r,acos:r,acosh:r,asin:r,asinh:r,atan:r,atanh:r,atan2:r,cbrt:r,ceil:r,clz32:r,cos:r,cosh:r,exp:r,expm1:r,floor:r,fround:r,hypot:r,imul:r,log:r,log1p:r,log10:r,log2:r,max:r,min:r,pow:r,round:r,sign:r,sin:r,sinh:r,sqrt:r,tan:r,tanh:r,trunc:r,idiv:!1,idivmod:!1,imod:!1,imuldiv:!1,irem:!1,mod:!1},b={"[[Proto]]":null,"%ThrowTypeError%":r,Infinity:"number",NaN:"number",undefined:"undefined","%UniqueEval%":r,isFinite:r,isNaN:r,parseFloat:r,parseInt:r,decodeURI:r,decodeURIComponent:r,encodeURI:r,encodeURIComponent:r,Object:{"[[Proto]]":"%FunctionPrototype%",assign:r,create:r,defineProperties:r,defineProperty:r,entries:r,freeze:r,fromEntries:r,getOwnPropertyDescriptor:r,getOwnPropertyDescriptors:r,getOwnPropertyNames:r,getOwnPropertySymbols:r,getPrototypeOf:r,hasOwn:r,is:r,isExtensible:r,isFrozen:r,isSealed:r,keys:r,preventExtensions:r,prototype:"%ObjectPrototype%",seal:r,setPrototypeOf:r,values:r},"%ObjectPrototype%":{"[[Proto]]":null,constructor:"Object",hasOwnProperty:r,isPrototypeOf:r,propertyIsEnumerable:r,toLocaleString:r,toString:r,valueOf:r,"--proto--":m,__defineGetter__:r,__defineSetter__:r,__lookupGetter__:r,__lookupSetter__:r},"%UniqueFunction%":{"[[Proto]]":"%FunctionPrototype%",prototype:"%FunctionPrototype%"},"%InertFunction%":{"[[Proto]]":"%FunctionPrototype%",prototype:"%FunctionPrototype%"},"%FunctionPrototype%":{apply:r,bind:r,call:r,constructor:"%InertFunction%",toString:r,"@@hasInstance":r,caller:!1,arguments:!1},Boolean:{"[[Proto]]":"%FunctionPrototype%",prototype:"%BooleanPrototype%"},"%BooleanPrototype%":{constructor:"Boolean",toString:r,valueOf:r},Symbol:{"[[Proto]]":"%FunctionPrototype%",asyncIterator:"symbol",for:r,hasInstance:"symbol",isConcatSpreadable:"symbol",iterator:"symbol",keyFor:r,match:"symbol",matchAll:"symbol",prototype:"%SymbolPrototype%",replace:"symbol",search:"symbol",species:"symbol",split:"symbol",toPrimitive:"symbol",toStringTag:"symbol",unscopables:"symbol"},"%SymbolPrototype%":{constructor:"Symbol",description:s,toString:r,valueOf:r,"@@toPrimitive":r,"@@toStringTag":"string"},"%InitialError%":{"[[Proto]]":"%FunctionPrototype%",prototype:"%ErrorPrototype%",captureStackTrace:r,stackTraceLimit:m,prepareStackTrace:m},"%SharedError%":{"[[Proto]]":"%FunctionPrototype%",prototype:"%ErrorPrototype%",captureStackTrace:r,stackTraceLimit:m,prepareStackTrace:m},"%ErrorPrototype%":{constructor:"%SharedError%",message:"string",name:"string",toString:r,at:!1,stack:m,cause:!1},EvalError:w("%EvalErrorPrototype%"),RangeError:w("%RangeErrorPrototype%"),ReferenceError:w("%ReferenceErrorPrototype%"),SyntaxError:w("%SyntaxErrorPrototype%"),TypeError:w("%TypeErrorPrototype%"),URIError:w("%URIErrorPrototype%"),"%EvalErrorPrototype%":O("EvalError"),"%RangeErrorPrototype%":O("RangeError"),"%ReferenceErrorPrototype%":O("ReferenceError"),"%SyntaxErrorPrototype%":O("SyntaxError"),"%TypeErrorPrototype%":O("TypeError"),"%URIErrorPrototype%":O("URIError"),Number:{"[[Proto]]":"%FunctionPrototype%",EPSILON:"number",isFinite:r,isInteger:r,isNaN:r,isSafeInteger:r,MAX_SAFE_INTEGER:"number",MAX_VALUE:"number",MIN_SAFE_INTEGER:"number",MIN_VALUE:"number",NaN:"number",NEGATIVE_INFINITY:"number",parseFloat:r,parseInt:r,POSITIVE_INFINITY:"number",prototype:"%NumberPrototype%"},"%NumberPrototype%":{constructor:"Number",toExponential:r,toFixed:r,toLocaleString:r,toPrecision:r,toString:r,valueOf:r},BigInt:{"[[Proto]]":"%FunctionPrototype%",asIntN:r,asUintN:r,prototype:"%BigIntPrototype%",bitLength:!1,fromArrayBuffer:!1},"%BigIntPrototype%":{constructor:"BigInt",toLocaleString:r,toString:r,valueOf:r,"@@toStringTag":"string"},"%InitialMath%":{...j,random:r},"%SharedMath%":j,"%InitialDate%":{"[[Proto]]":"%FunctionPrototype%",now:r,parse:r,prototype:"%DatePrototype%",UTC:r},"%SharedDate%":{"[[Proto]]":"%FunctionPrototype%",now:r,parse:r,prototype:"%DatePrototype%",UTC:r},"%DatePrototype%":{constructor:"%SharedDate%",getDate:r,getDay:r,getFullYear:r,getHours:r,getMilliseconds:r,getMinutes:r,getMonth:r,getSeconds:r,getTime:r,getTimezoneOffset:r,getUTCDate:r,getUTCDay:r,getUTCFullYear:r,getUTCHours:r,getUTCMilliseconds:r,getUTCMinutes:r,getUTCMonth:r,getUTCSeconds:r,setDate:r,setFullYear:r,setHours:r,setMilliseconds:r,setMinutes:r,setMonth:r,setSeconds:r,setTime:r,setUTCDate:r,setUTCFullYear:r,setUTCHours:r,setUTCMilliseconds:r,setUTCMinutes:r,setUTCMonth:r,setUTCSeconds:r,toDateString:r,toISOString:r,toJSON:r,toLocaleDateString:r,toLocaleString:r,toLocaleTimeString:r,toString:r,toTimeString:r,toUTCString:r,valueOf:r,"@@toPrimitive":r,getYear:r,setYear:r,toGMTString:r},String:{"[[Proto]]":"%FunctionPrototype%",fromCharCode:r,fromCodePoint:r,prototype:"%StringPrototype%",raw:r,fromArrayBuffer:!1},"%StringPrototype%":{length:"number",at:r,charAt:r,charCodeAt:r,codePointAt:r,concat:r,constructor:"String",endsWith:r,includes:r,indexOf:r,lastIndexOf:r,localeCompare:r,match:r,matchAll:r,normalize:r,padEnd:r,padStart:r,repeat:r,replace:r,replaceAll:r,search:r,slice:r,split:r,startsWith:r,substring:r,toLocaleLowerCase:r,toLocaleUpperCase:r,toLowerCase:r,toString:r,toUpperCase:r,trim:r,trimEnd:r,trimStart:r,valueOf:r,"@@iterator":r,substr:r,anchor:r,big:r,blink:r,bold:r,fixed:r,fontcolor:r,fontsize:r,italics:r,link:r,small:r,strike:r,sub:r,sup:r,trimLeft:r,trimRight:r,compare:!1},"%StringIteratorPrototype%":{"[[Proto]]":"%IteratorPrototype%",next:r,"@@toStringTag":"string"},"%InitialRegExp%":{"[[Proto]]":"%FunctionPrototype%",prototype:"%RegExpPrototype%","@@species":s,input:!1,$_:!1,lastMatch:!1,"$&":!1,lastParen:!1,"$+":!1,leftContext:!1,"$`":!1,rightContext:!1,"$'":!1,$1:!1,$2:!1,$3:!1,$4:!1,$5:!1,$6:!1,$7:!1,$8:!1,$9:!1},"%SharedRegExp%":{"[[Proto]]":"%FunctionPrototype%",prototype:"%RegExpPrototype%","@@species":s},"%RegExpPrototype%":{constructor:"%SharedRegExp%",exec:r,dotAll:s,flags:s,global:s,ignoreCase:s,"@@match":r,"@@matchAll":r,multiline:s,"@@replace":r,"@@search":r,source:s,"@@split":r,sticky:s,test:r,toString:r,unicode:s,compile:!1,hasIndices:!1},"%RegExpStringIteratorPrototype%":{"[[Proto]]":"%IteratorPrototype%",next:r,"@@toStringTag":"string"},Array:{"[[Proto]]":"%FunctionPrototype%",from:r,isArray:r,of:r,prototype:"%ArrayPrototype%","@@species":s,at:r},"%ArrayPrototype%":{at:r,length:"number",concat:r,constructor:"Array",copyWithin:r,entries:r,every:r,fill:r,filter:r,find:r,findIndex:r,flat:r,flatMap:r,forEach:r,includes:r,indexOf:r,join:r,keys:r,lastIndexOf:r,map:r,pop:r,push:r,reduce:r,reduceRight:r,reverse:r,shift:r,slice:r,some:r,sort:r,splice:r,toLocaleString:r,toString:r,unshift:r,values:r,"@@iterator":r,"@@unscopables":{"[[Proto]]":null,copyWithin:"boolean",entries:"boolean",fill:"boolean",find:"boolean",findIndex:"boolean",flat:"boolean",flatMap:"boolean",includes:"boolean",keys:"boolean",values:"boolean",at:!1,findLast:"boolean",findLastIndex:"boolean"},findLast:r,findLastIndex:r},"%ArrayIteratorPrototype%":{"[[Proto]]":"%IteratorPrototype%",next:r,"@@toStringTag":"string"},"%TypedArray%":{"[[Proto]]":"%FunctionPrototype%",from:r,of:r,prototype:"%TypedArrayPrototype%","@@species":s},"%TypedArrayPrototype%":{at:r,buffer:s,byteLength:s,byteOffset:s,constructor:"%TypedArray%",copyWithin:r,entries:r,every:r,fill:r,filter:r,find:r,findIndex:r,forEach:r,includes:r,indexOf:r,join:r,keys:r,lastIndexOf:r,length:s,map:r,reduce:r,reduceRight:r,reverse:r,set:r,slice:r,some:r,sort:r,subarray:r,toLocaleString:r,toString:r,values:r,"@@iterator":r,"@@toStringTag":s,findLast:r,findLastIndex:r},BigInt64Array:S("%BigInt64ArrayPrototype%"),BigUint64Array:S("%BigUint64ArrayPrototype%"),Float32Array:S("%Float32ArrayPrototype%"),Float64Array:S("%Float64ArrayPrototype%"),Int16Array:S("%Int16ArrayPrototype%"),Int32Array:S("%Int32ArrayPrototype%"),Int8Array:S("%Int8ArrayPrototype%"),Uint16Array:S("%Uint16ArrayPrototype%"),Uint32Array:S("%Uint32ArrayPrototype%"),Uint8Array:S("%Uint8ArrayPrototype%"),Uint8ClampedArray:S("%Uint8ClampedArrayPrototype%"),"%BigInt64ArrayPrototype%":g("BigInt64Array"),"%BigUint64ArrayPrototype%":g("BigUint64Array"),"%Float32ArrayPrototype%":g("Float32Array"),"%Float64ArrayPrototype%":g("Float64Array"),"%Int16ArrayPrototype%":g("Int16Array"),"%Int32ArrayPrototype%":g("Int32Array"),"%Int8ArrayPrototype%":g("Int8Array"),"%Uint16ArrayPrototype%":g("Uint16Array"),"%Uint32ArrayPrototype%":g("Uint32Array"),"%Uint8ArrayPrototype%":g("Uint8Array"),"%Uint8ClampedArrayPrototype%":g("Uint8ClampedArray"),Map:{"[[Proto]]":"%FunctionPrototype%","@@species":s,prototype:"%MapPrototype%"},"%MapPrototype%":{clear:r,constructor:"Map",delete:r,entries:r,forEach:r,get:r,has:r,keys:r,set:r,size:s,values:r,"@@iterator":r,"@@toStringTag":"string"},"%MapIteratorPrototype%":{"[[Proto]]":"%IteratorPrototype%",next:r,"@@toStringTag":"string"},Set:{"[[Proto]]":"%FunctionPrototype%",prototype:"%SetPrototype%","@@species":s},"%SetPrototype%":{add:r,clear:r,constructor:"Set",delete:r,entries:r,forEach:r,has:r,keys:r,size:s,values:r,"@@iterator":r,"@@toStringTag":"string"},"%SetIteratorPrototype%":{"[[Proto]]":"%IteratorPrototype%",next:r,"@@toStringTag":"string"},WeakMap:{"[[Proto]]":"%FunctionPrototype%",prototype:"%WeakMapPrototype%"},"%WeakMapPrototype%":{constructor:"WeakMap",delete:r,get:r,has:r,set:r,"@@toStringTag":"string"},WeakSet:{"[[Proto]]":"%FunctionPrototype%",prototype:"%WeakSetPrototype%"},"%WeakSetPrototype%":{add:r,constructor:"WeakSet",delete:r,has:r,"@@toStringTag":"string"},ArrayBuffer:{"[[Proto]]":"%FunctionPrototype%",isView:r,prototype:"%ArrayBufferPrototype%","@@species":s,fromString:!1,fromBigInt:!1},"%ArrayBufferPrototype%":{byteLength:s,constructor:"ArrayBuffer",slice:r,"@@toStringTag":"string",concat:!1,transfer:r,resize:r,resizable:s,maxByteLength:s},SharedArrayBuffer:!1,"%SharedArrayBufferPrototype%":!1,DataView:{"[[Proto]]":"%FunctionPrototype%",BYTES_PER_ELEMENT:"number",prototype:"%DataViewPrototype%"},"%DataViewPrototype%":{buffer:s,byteLength:s,byteOffset:s,constructor:"DataView",getBigInt64:r,getBigUint64:r,getFloat32:r,getFloat64:r,getInt8:r,getInt16:r,getInt32:r,getUint8:r,getUint16:r,getUint32:r,setBigInt64:r,setBigUint64:r,setFloat32:r,setFloat64:r,setInt8:r,setInt16:r,setInt32:r,setUint8:r,setUint16:r,setUint32:r,"@@toStringTag":"string"},Atomics:!1,JSON:{parse:r,stringify:r,"@@toStringTag":"string"},"%IteratorPrototype%":{"@@iterator":r},"%AsyncIteratorPrototype%":{"@@asyncIterator":r},"%InertGeneratorFunction%":{"[[Proto]]":"%InertFunction%",prototype:"%Generator%"},"%Generator%":{"[[Proto]]":"%FunctionPrototype%",constructor:"%InertGeneratorFunction%",prototype:"%GeneratorPrototype%","@@toStringTag":"string"},"%InertAsyncGeneratorFunction%":{"[[Proto]]":"%InertFunction%",prototype:"%AsyncGenerator%"},"%AsyncGenerator%":{"[[Proto]]":"%FunctionPrototype%",constructor:"%InertAsyncGeneratorFunction%",prototype:"%AsyncGeneratorPrototype%","@@toStringTag":"string"},"%GeneratorPrototype%":{"[[Proto]]":"%IteratorPrototype%",constructor:"%Generator%",next:r,return:r,throw:r,"@@toStringTag":"string"},"%AsyncGeneratorPrototype%":{"[[Proto]]":"%AsyncIteratorPrototype%",constructor:"%AsyncGenerator%",next:r,return:r,throw:r,"@@toStringTag":"string"},HandledPromise:{"[[Proto]]":"Promise",applyFunction:r,applyFunctionSendOnly:r,applyMethod:r,applyMethodSendOnly:r,get:r,getSendOnly:r,prototype:"%PromisePrototype%",resolve:r},Promise:{"[[Proto]]":"%FunctionPrototype%",all:r,allSettled:r,any:r,prototype:"%PromisePrototype%",race:r,reject:r,resolve:r,"@@species":s},"%PromisePrototype%":{catch:r,constructor:"Promise",finally:r,then:r,"@@toStringTag":"string","UniqueSymbol(async_id_symbol)":m,"UniqueSymbol(trigger_async_id_symbol)":m,"UniqueSymbol(destroyed)":m},"%InertAsyncFunction%":{"[[Proto]]":"%InertFunction%",prototype:"%AsyncFunctionPrototype%"},"%AsyncFunctionPrototype%":{"[[Proto]]":"%FunctionPrototype%",constructor:"%InertAsyncFunction%","@@toStringTag":"string"},Reflect:{apply:r,construct:r,defineProperty:r,deleteProperty:r,get:r,getOwnPropertyDescriptor:r,getPrototypeOf:r,has:r,isExtensible:r,ownKeys:r,preventExtensions:r,set:r,setPrototypeOf:r,"@@toStringTag":"string"},Proxy:{"[[Proto]]":"%FunctionPrototype%",revocable:r},escape:r,unescape:r,"%UniqueCompartment%":{"[[Proto]]":"%FunctionPrototype%",prototype:"%CompartmentPrototype%",toString:r},"%InertCompartment%":{"[[Proto]]":"%FunctionPrototype%",prototype:"%CompartmentPrototype%",toString:r},"%CompartmentPrototype%":{constructor:"%InertCompartment%",evaluate:r,globalThis:s,name:s,toString:r,__isKnownScopeProxy__:r,import:v,load:v,importNow:r,module:r},lockdown:r,harden:r,"%InitialGetStackString%":r};a.whitelist(b)},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s,m;i([["./commons.js",[["defineProperty",[w=>d=w]],["objectHasOwnProperty",[w=>h=w]],["entries",[w=>c=w]]]],["./make-eval-function.js",[["makeEvalFunction",[w=>r=w]]]],["./make-function-constructor.js",[["makeFunctionConstructor",[w=>v=w]]]],["./whitelist.js",[["constantProperties",[w=>s=w]],["universalPropertyNames",[w=>m=w]]]]]),a.setGlobalObjectConstantProperties(w=>{for(let[O,S]of c(s))d(w,O,{value:S,writable:!1,enumerable:!1,configurable:!1})}),a.setGlobalObjectMutableProperties((w,{intrinsics:O,newGlobalPropertyNames:S,makeCompartmentConstructor:g,markVirtualizedNativeFunction:j})=>{for(let[u,k]of c(m))h(O,k)&&d(w,u,{value:O[k],writable:!0,enumerable:!1,configurable:!0});for(let[u,k]of c(S))h(O,k)&&d(w,u,{value:O[k],writable:!0,enumerable:!1,configurable:!0});let b={globalThis:w};b.Compartment=g(g,O,j);for(let[u,k]of c(b))d(w,u,{value:k,writable:!0,enumerable:!1,configurable:!0}),typeof k=="function"&&j(k)}),a.setGlobalObjectEvaluators((w,O,S)=>{{let g=r(O);S(g),d(w,"eval",{value:g,writable:!0,enumerable:!1,configurable:!0})}{let g=v(O);S(g),d(w,"Function",{value:g,writable:!0,enumerable:!1,configurable:!0})}})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s,m,w,O,S,g,j,b,u,k,f,E,I;i([["./commons.js",[["ReferenceError",[F=>d=F]],["TypeError",[F=>h=F]],["Map",[F=>c=F]],["Set",[F=>r=F]],["arrayJoin",[F=>v=F]],["arrayMap",[F=>s=F]],["arrayPush",[F=>m=F]],["create",[F=>w=F]],["freeze",[F=>O=F]],["mapGet",[F=>S=F]],["mapHas",[F=>g=F]],["mapSet",[F=>j=F]],["setAdd",[F=>b=F]],["promiseCatch",[F=>u=F]],["promiseThen",[F=>k=F]],["values",[F=>f=F]],["weakmapGet",[F=>E=F]]]],["./error/assert.js",[["assert",[F=>I=F]]]]]);let{details:y,quote:D}=I,L=()=>{};a.makeAlias((F,P)=>O({compartment:F,specifier:P}));let T=async(F,P,_,N,G,H,V,C)=>{let{resolveHook:Y,moduleRecords:W}=E(F,_),U=((z,J,B)=>{let K=w(null);for(let M of z){let Q=J(M,B);K[M]=Q}return O(K)})(G.imports,Y,N),A=O({compartment:_,staticModuleRecord:G,moduleSpecifier:N,resolvedImports:U});for(let z of f(U)){let J=x(F,P,_,z,H,V,C);b(H,k(J,L,B=>{m(C,B)}))}return j(W,N,A),A},x=async(F,P,_,N,G,H,V)=>{let{name:C}=E(F,_),Y=S(H,_);Y===void 0&&(Y=new c,j(H,_,Y));let W=S(Y,N);return W!==void 0||(W=u((async(U,A,z,J,B,K,M)=>{let{importHook:Q,moduleMap:R,moduleMapHook:q,moduleRecords:$}=E(U,z),Z=R[J];if(Z===void 0&&q!==void 0&&(Z=q(J)),typeof Z=="string")I.fail(y`Cannot map module ${D(J)} to ${D(Z)} in parent compartment, not yet implemented`,h);else if(Z!==void 0){let ie=E(A,Z);ie===void 0&&I.fail(y`Cannot map module ${D(J)} because the value is not a module exports namespace, or is from another realm`,d);let ae=await x(U,A,ie.compartment,ie.specifier,B,K,M);return j($,J,ae),ae}if(g($,J))return S($,J);let ee=await Q(J);if(ee!==null&&typeof ee=="object"||I.fail(y`importHook must return a promise for an object, for module ${D(J)} in compartment ${D(z.name)}`),ee.record!==void 0){let{compartment:ie=z,specifier:ae=J,record:se}=ee,te=await T(U,A,ie,ae,se,B,K,M);return j($,J,te),te}return T(U,A,z,J,ee,B,K,M)})(F,P,_,N,G,H,V),U=>{throw I.note(U,y`${U.message}, loading ${D(N)} in compartment ${D(C)}`),U}),j(Y,N,W)),W};a.load(async(F,P,_,N)=>{let{name:G}=E(F,_),H=new r,V=new c,C=[],Y=x(F,P,_,N,H,V,C);b(H,k(Y,L,W=>{m(C,W)}));for(let W of H)await W;if(C.length>0)throw new h(`Failed to load module ${D(N)} in package ${D(G)} (${C.length} underlying failures: ${v(s(C,W=>W.message),", ")}`)})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s,m,w,O,S,g,j,b,u,k,f;i([["./module-load.js",[["makeAlias",[y=>d=y]]]],["./commons.js",[["Proxy",[y=>h=y]],["TypeError",[y=>c=y]],["create",[y=>r=y]],["freeze",[y=>v=y]],["mapGet",[y=>s=y]],["mapHas",[y=>m=y]],["mapSet",[y=>w=y]],["ownKeys",[y=>O=y]],["reflectGet",[y=>S=y]],["reflectGetOwnPropertyDescriptor",[y=>g=y]],["reflectHas",[y=>j=y]],["reflectIsExtensible",[y=>b=y]],["reflectPreventExtensions",[y=>u=y]],["weakmapSet",[y=>k=y]]]],["./error/assert.js",[["assert",[y=>f=y]]]]]);let{quote:E}=f,I=()=>{let y=!1,D=r(null);return v({activate(){y=!0},proxiedExports:D,exportsProxy:new h(D,{get(L,T,x){if(!y)throw new c(`Cannot get property ${E(T)} of module exports namespace, the module has not yet begun to execute`);return S(D,T,x)},set(L,T,x){throw new c(`Cannot set property ${E(T)} of module exports namespace`)},has(L,T){if(!y)throw new c(`Cannot check property ${E(T)}, the module has not yet begun to execute`);return j(D,T)},deleteProperty(L,T){throw new c(`Cannot delete property ${E(T)}s of module exports namespace`)},ownKeys(L){if(!y)throw new c("Cannot enumerate keys, the module has not yet begun to execute");return O(D)},getOwnPropertyDescriptor(L,T){if(!y)throw new c(`Cannot get own property descriptor ${E(T)}, the module has not yet begun to execute`);return g(D,T)},preventExtensions(L){if(!y)throw new c("Cannot prevent extensions of module exports namespace, the module has not yet begun to execute");return u(D)},isExtensible(){if(!y)throw new c("Cannot check extensibility of module exports namespace, the module has not yet begun to execute");return b(D)},getPrototypeOf:L=>null,setPrototypeOf(L,T){throw new c("Cannot set prototype of module exports namespace")},defineProperty(L,T,x){throw new c(`Cannot define property ${E(T)} of module exports namespace`)},apply(L,T,x){throw new c("Cannot call module exports namespace, it is not a function")},construct(L,T){throw new c("Cannot construct module exports namespace, it is not a constructor")}})})};a.deferExports(I),a.getDeferredExports((y,D,L,T)=>{let{deferredExports:x}=D;if(!m(x,T)){let F=I();k(L,F.exportsProxy,d(y,T)),w(x,T,F)}return s(x,T)})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s,m,w,O,S,g,j,b,u,k,f,E,I,y,D;i([["./error/assert.js",[["assert",[T=>d=T]]]],["./module-proxy.js",[["getDeferredExports",[T=>h=T]]]],["./commons.js",[["ReferenceError",[T=>c=T]],["SyntaxError",[T=>r=T]],["TypeError",[T=>v=T]],["arrayForEach",[T=>s=T]],["arrayIncludes",[T=>m=T]],["arrayPush",[T=>w=T]],["arraySome",[T=>O=T]],["arraySort",[T=>S=T]],["create",[T=>g=T]],["defineProperty",[T=>j=T]],["entries",[T=>b=T]],["freeze",[T=>u=T]],["isArray",[T=>k=T]],["keys",[T=>f=T]],["mapGet",[T=>E=T]],["weakmapGet",[T=>I=T]],["reflectHas",[T=>y=T]]]],["./compartment-evaluate.js",[["compartmentEvaluate",[T=>D=T]]]]]);let{quote:L}=d;a.makeThirdPartyModuleInstance((T,x,F,P,_,N)=>{let{exportsProxy:G,proxiedExports:H,activate:V}=h(F,I(T,F),P,_),C=g(null);if(x.exports){if(!k(x.exports)||O(x.exports,W=>typeof W!="string"))throw new v('SES third-party static module record "exports" property must be an array of strings for module '+_);s(x.exports,W=>{let U=H[W],A=[];j(H,W,{get:()=>U,set:z=>{U=z;for(let J of A)J(z)},enumerable:!0,configurable:!1}),C[W]=z=>{w(A,z),z(U)}}),C["*"]=W=>{W(H)}}let Y={activated:!1};return u({notifiers:C,exportsProxy:G,execute(){if(y(Y,"errorFromExecute"))throw Y.errorFromExecute;if(!Y.activated){V(),Y.activated=!0;try{x.execute(H,F,N)}catch(W){throw Y.errorFromExecute=W,W}}}})}),a.makeModuleInstance((T,x,F,P)=>{let{compartment:_,moduleSpecifier:N,staticModuleRecord:G}=F,{reexports:H=[],__syncModuleProgram__:V,__fixedExportMap__:C={},__liveExportMap__:Y={}}=G,W=I(T,_),{__shimTransforms__:U}=W,{exportsProxy:A,proxiedExports:z,activate:J}=h(_,W,x,N),B=g(null),K=g(null),M=g(null),Q=g(null),R=g(null),q=g(null);s(b(C),([ae,[se]])=>{let te=R[se];if(!te){let re,oe=!0,le=[],me=()=>{if(oe)throw new c(`binding ${L(se)} not yet initialized`);return re},pe=u(ue=>{if(!oe)throw new v(`Internal: binding ${L(se)} already initialized`);re=ue;let he=le;le=null,oe=!1;for(let ce of he)ce(ue);return ue});te={get:me,notify:ue=>{ue!==pe&&(oe?w(le,ue):ue(re))}},R[se]=te,M[se]=pe}B[ae]={get:te.get,set:void 0,enumerable:!0,configurable:!1},q[ae]=te.notify}),s(b(Y),([ae,[se,te]])=>{let re=R[se];if(!re){let oe,le=!0,me=[],pe=()=>{if(le)throw new c(`binding ${L(ae)} not yet initialized`);return oe},ue=u(ce=>{oe=ce,le=!1;for(let be of me)be(ce)}),he=ce=>{if(le)throw new c(`binding ${L(se)} not yet initialized`);oe=ce;for(let be of me)be(ce)};re={get:pe,notify:ce=>{ce!==ue&&(w(me,ce),le||ce(oe))}},R[se]=re,te&&j(K,se,{get:pe,set:he,enumerable:!0,configurable:!1}),Q[se]=ue}B[ae]={get:re.get,set:void 0,enumerable:!0,configurable:!1},q[ae]=re.notify});function $(ae){let se=g(null);se.default=!1;for(let[te,re]of ae){let oe=E(P,te);oe.execute();let{notifiers:le}=oe;for(let[me,pe]of re){let ue=le[me];if(!ue)throw r(`The requested module '${te}' does not provide an export named '${me}'`);for(let he of pe)ue(he)}if(m(H,te))for(let[me,pe]of b(le))se[me]===void 0?se[me]=pe:se[me]=!1}for(let[te,re]of b(se))if(!q[te]&&re!==!1){let oe;q[te]=re,re(le=>oe=le),B[te]={get:()=>oe,set:void 0,enumerable:!0,configurable:!1}}s(S(f(B)),te=>j(z,te,B[te])),u(z),J()}q["*"]=ae=>{ae(z)};let Z,ee=D(W,V,{globalObject:_.globalThis,transforms:U,__moduleShimLexicals__:K}),ie=!1;return u({notifiers:q,exportsProxy:A,execute:function(){if(ee){let ae=ee;ee=null;try{ae(u({imports:u($),onceVar:u(M),liveVar:u(Q)}))}catch(se){ie=!0,Z=se}}if(ie)throw Z}})})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s,m,w,O,S,g,j,b;i([["./error/assert.js",[["assert",[E=>d=E]]]],["./module-instance.js",[["makeModuleInstance",[E=>h=E]],["makeThirdPartyModuleInstance",[E=>c=E]]]],["./commons.js",[["Map",[E=>r=E]],["ReferenceError",[E=>v=E]],["TypeError",[E=>s=E]],["entries",[E=>m=E]],["isArray",[E=>w=E]],["isObject",[E=>O=E]],["mapGet",[E=>S=E]],["mapHas",[E=>g=E]],["mapSet",[E=>j=E]],["weakmapGet",[E=>b=E]]]]]);let{quote:u}=d,k=(E,I,y,D)=>{let{name:L,moduleRecords:T}=b(E,y),x=S(T,D);if(x===void 0)throw new v(`Missing link to module ${u(D)} from compartment ${u(L)}`);return f(E,I,x)};a.link(k);let f=(E,I,y)=>{let{compartment:D,moduleSpecifier:L,resolvedImports:T,staticModuleRecord:x}=y,{instances:F}=b(E,D);if(g(F,L))return S(F,L);(function(N,G){d(O(N),`Static module records must be of type object, got ${u(N)}, for module ${u(G)}`);let{imports:H,exports:V,reexports:C=[]}=N;d(w(H),`Property 'imports' of a static module record must be an array, got ${u(H)}, for module ${u(G)}`),d(w(V),`Property 'exports' of a precompiled module record must be an array, got ${u(V)}, for module ${u(G)}`),d(w(C),`Property 'reexports' of a precompiled module record must be an array if present, got ${u(C)}, for module ${u(G)}`)})(x,L);let P=new r,_;if(function(N){return typeof N.__syncModuleProgram__=="string"}(x))(function(N,G){let{__fixedExportMap__:H,__liveExportMap__:V}=N;d(O(H),`Property '__fixedExportMap__' of a precompiled module record must be an object, got ${u(H)}, for module ${u(G)}`),d(O(V),`Property '__liveExportMap__' of a precompiled module record must be an object, got ${u(V)}, for module ${u(G)}`)})(x,L),_=h(E,I,y,P);else{if(!function(N){return typeof N.execute=="function"}(x))throw new s("importHook must return a static module record, got "+u(x));(function(N,G){let{exports:H}=N;d(w(H),`Property 'exports' of a third-party static module record must be an array, got ${u(H)}, for module ${u(G)}`)})(x,L),_=c(E,x,D,I,L,T)}j(F,L,_);for(let[N,G]of m(T)){let H=k(E,I,D,G);j(P,N,H)}return _};a.instantiate(f)},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s,m,w,O,S,g,j,b,u,k,f,E,I,y,D,L,T,x,F,P,_,N;i([["./commons.js",[["Map",[A=>d=A]],["ReferenceError",[A=>h=A]],["TypeError",[A=>c=A]],["WeakMap",[A=>r=A]],["WeakSet",[A=>v=A]],["arrayFilter",[A=>s=A]],["arrayJoin",[A=>m=A]],["assign",[A=>w=A]],["defineProperties",[A=>O=A]],["entries",[A=>S=A]],["freeze",[A=>g=A]],["getOwnPropertyNames",[A=>j=A]],["promiseThen",[A=>b=A]],["weakmapGet",[A=>u=A]],["weakmapSet",[A=>k=A]],["weaksetHas",[A=>f=A]]]],["./global-object.js",[["setGlobalObjectConstantProperties",[A=>E=A]],["setGlobalObjectMutableProperties",[A=>I=A]],["setGlobalObjectEvaluators",[A=>y=A]]]],["./scope-constants.js",[["isValidIdentifierName",[A=>D=A]]]],["./whitelist.js",[["sharedGlobalPropertyNames",[A=>L=A]]]],["./module-load.js",[["load",[A=>T=A]]]],["./module-link.js",[["link",[A=>x=A]]]],["./module-proxy.js",[["getDeferredExports",[A=>F=A]]]],["./error/assert.js",[["assert",[A=>P=A]]]],["./compartment-evaluate.js",[["compartmentEvaluate",[A=>_=A]]]],["./make-safe-evaluator.js",[["makeSafeEvaluator",[A=>N=A]]]]]);let{quote:G}=P,H=new r,V=new r,C=A=>{let{importHook:z,resolveHook:J}=u(V,A);if(typeof z!="function"||typeof J!="function")throw new c("Compartment must be constructed with an importHook and a resolveHook for it to be able to load modules")},Y=function(A={},z={},J={}){throw new c("Compartment.prototype.constructor is not a valid constructor.")};a.InertCompartment(Y);let W=(A,z)=>{let{execute:J,exportsProxy:B}=x(V,H,A,z);return J(),B},U={constructor:Y,get globalThis(){return u(V,this).globalObject},get name(){return u(V,this).name},evaluate(A,z={}){let J=u(V,this);return _(J,A,z)},toString:()=>"[object Compartment]",__isKnownScopeProxy__(A){let{knownScopeProxies:z}=u(V,this);return f(z,A)},module(A){if(typeof A!="string")throw new c("first argument of module() must be a string");C(this);let{exportsProxy:z}=F(this,u(V,this),H,A);return z},async import(A){if(typeof A!="string")throw new c("first argument of import() must be a string");return C(this),b(T(V,H,this,A),()=>({namespace:W(this,A)}))},async load(A){if(typeof A!="string")throw new c("first argument of load() must be a string");return C(this),T(V,H,this,A)},importNow(A){if(typeof A!="string")throw new c("first argument of importNow() must be a string");return C(this),W(this,A)}};a.CompartmentPrototype(U),O(Y,{prototype:{value:U}}),a.makeCompartmentConstructor((A,z,J)=>{function B(K={},M={},Q={}){if(new.target===void 0)throw new c("Class constructor Compartment cannot be invoked without 'new'");let{name:R="<unknown>",transforms:q=[],__shimTransforms__:$=[],globalLexicals:Z={},resolveHook:ee,importHook:ie,moduleMapHook:ae}=Q,se=[...q,...$],te=new d,re=new d,oe=new d;for(let[ce,be]of S(M||{})){if(typeof be=="string")throw new c(`Cannot map module ${G(ce)} to ${G(be)} in parent compartment`);if(u(H,be)===void 0)throw h(`Cannot map module ${G(ce)} because it has no known compartment in this realm`)}let le=s(j(Z),ce=>!D(ce));if(le.length)throw new c(`Cannot create compartment with invalid names for global lexicals: ${m(le,", ")}; these names would not be lexically mentionable`);let me=g({...Z}),pe={};E(pe);let ue=new v,{safeEvaluate:he}=N({globalObject:pe,globalLexicals:me,globalTransforms:se,sloppyGlobalsMode:!1,knownScopeProxies:ue});I(pe,{intrinsics:z,newGlobalPropertyNames:L,makeCompartmentConstructor:A,markVirtualizedNativeFunction:J}),y(pe,he,J),w(pe,K),k(V,this,{name:""+R,globalTransforms:se,globalObject:pe,knownScopeProxies:ue,globalLexicals:me,safeEvaluate:he,resolveHook:ee,importHook:ie,moduleMap:M,moduleMapHook:ae,moduleRecords:te,__shimTransforms__:$,deferredExports:oe,instances:re})}return B.prototype=U,B})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s,m,w,O,S,g,j,b,u,k,f,E,I;i([["./commons.js",[["TypeError",[x=>d=x]],["WeakSet",[x=>h=x]],["arrayFilter",[x=>c=x]],["defineProperty",[x=>r=x]],["entries",[x=>v=x]],["freeze",[x=>s=x]],["getOwnPropertyDescriptor",[x=>m=x]],["getOwnPropertyDescriptors",[x=>w=x]],["globalThis",[x=>O=x]],["is",[x=>S=x]],["isObject",[x=>g=x]],["objectHasOwnProperty",[x=>j=x]],["values",[x=>b=x]],["weaksetHas",[x=>u=x]]]],["./whitelist.js",[["constantProperties",[x=>k=x]],["sharedGlobalPropertyNames",[x=>f=x]],["universalPropertyNames",[x=>E=x]],["whitelist",[x=>I=x]]]]]);let y=x=>typeof x=="function";function D(x,F,P){if(j(x,F)){let _=m(x,F);if(!S(_.value,P.value)||_.get!==P.get||_.set!==P.set||_.writable!==P.writable||_.enumerable!==P.enumerable||_.configurable!==P.configurable)throw new d("Conflicting definitions of "+F)}r(x,F,P)}function L(x,F){let P={__proto__:null};for(let[_,N]of v(F))j(x,_)&&(P[N]=x[_]);return P}let T=()=>{let x={__proto__:null},F,P=V=>{(function(C,Y){for(let[W,U]of v(Y))D(C,W,U)})(x,w(V))};s(P);let _=()=>{for(let[V,C]of v(x)){if(!g(C)||!j(C,"prototype"))continue;let Y=I[V];if(typeof Y!="object")throw new d("Expected permit object at whitelist."+V);let W=Y.prototype;if(!W)throw new d(V+".prototype property not whitelisted");if(typeof W!="string"||!j(I,W))throw new d(`Unrecognized ${V}.prototype whitelist entry`);let U=C.prototype;if(j(x,W)){if(x[W]!==U)throw new d("Conflicting bindings of "+W)}else x[W]=U}};s(_);let N=()=>(s(x),F=new h(c(b(x),y)),x);s(N);let G=V=>{if(!F)throw new d("isPseudoNative can only be called after finalIntrinsics");return u(F,V)};s(G);let H={addIntrinsics:P,completePrototypes:_,finalIntrinsics:N,isPseudoNative:G};return s(H),P(k),P(L(O,E)),H};a.makeIntrinsicsCollector(T),a.getGlobalIntrinsics(x=>{let{addIntrinsics:F,finalIntrinsics:P}=T();return F(L(x,f)),P()})},({imports:i,liveVar:p,onceVar:a})=>{i([]),a.minEnablements({"%ObjectPrototype%":{toString:!0},"%FunctionPrototype%":{toString:!0},"%ErrorPrototype%":{name:!0}});let d={"%ObjectPrototype%":{toString:!0,valueOf:!0},"%ArrayPrototype%":{toString:!0,push:!0},"%FunctionPrototype%":{constructor:!0,bind:!0,toString:!0},"%ErrorPrototype%":{constructor:!0,message:!0,name:!0,toString:!0},"%TypeErrorPrototype%":{constructor:!0,message:!0,name:!0},"%SyntaxErrorPrototype%":{message:!0,name:!0},"%RangeErrorPrototype%":{message:!0,name:!0},"%URIErrorPrototype%":{message:!0,name:!0},"%EvalErrorPrototype%":{message:!0,name:!0},"%ReferenceErrorPrototype%":{message:!0,name:!0},"%PromisePrototype%":{constructor:!0},"%TypedArrayPrototype%":"*","%Generator%":{constructor:!0,name:!0,toString:!0},"%IteratorPrototype%":{toString:!0}};a.moderateEnablements(d);let h={...d,"%ObjectPrototype%":"*","%TypedArrayPrototype%":"*"};a.severeEnablements(h)},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s,m,w,O,S,g,j,b,u,k;i([["./commons.js",[["Set",[f=>d=f]],["String",[f=>h=f]],["TypeError",[f=>c=f]],["arrayForEach",[f=>r=f]],["defineProperty",[f=>v=f]],["getOwnPropertyDescriptor",[f=>s=f]],["getOwnPropertyDescriptors",[f=>m=f]],["getOwnPropertyNames",[f=>w=f]],["isObject",[f=>O=f]],["objectHasOwnProperty",[f=>S=f]],["ownKeys",[f=>g=f]],["setHas",[f=>j=f]]]],["./enablements.js",[["minEnablements",[f=>b=f]],["moderateEnablements",[f=>u=f]],["severeEnablements",[f=>k=f]]]]]),a.default(function(f,E,I=[]){let y=new d(I);function D(F,P,_,N){if("value"in N&&N.configurable){let H=function(){return G},{value:G}=N;v(H,"originalValue",{value:G,writable:!1,enumerable:!1,configurable:!1});let V=j(y,_);v(P,_,{get:H,set:function(C){if(P===this)throw new c(`Cannot assign to read only property '${h(_)}' of '${F}'`);S(this,_)?this[_]=C:(V&&console.error(new c("Override property "+_)),v(this,_,{value:C,writable:!0,enumerable:!0,configurable:!0}))},enumerable:N.enumerable,configurable:N.configurable})}}function L(F,P,_){let N=s(P,_);N&&D(F,P,_,N)}function T(F,P){let _=m(P);_&&r(g(_),N=>D(F,P,N,_[N]))}let x;switch(E){case"min":x=b;break;case"moderate":x=u;break;case"severe":x=k;break;default:throw new c("unrecognized overrideTaming "+E)}(function F(P,_,N){for(let G of w(N)){let H=s(_,G);if(!H||H.get||H.set)continue;let V=`${P}.${h(G)}`,C=N[G];if(C===!0)L(V,_,G);else if(C==="*")T(V,H.value);else{if(!O(C))throw new c("Unexpected override enablement plan "+V);F(V,H.value,C)}}})("root",f,x)})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r;i([["./commons.js",[["arrayPush",[w=>d=w]],["arraySlice",[w=>h=w]],["freeze",[w=>c=w]]]],["./error/assert.js",[["assert",[w=>r=w]]]]]);let{details:v,quote:s}=r,m=w=>{let O=[],S=(j,b)=>{r.typeof(j,"string",v`Environment option name ${s(j)} must be a string.`),r.typeof(b,"string",v`Environment option default setting ${s(b)} must be a string.`);let u=b,k=w.process;if(k&&typeof k=="object"){let f=k.env;if(f&&typeof f=="object"&&j in f){d(O,j);let E=f[j];r.typeof(E,"string",v`Environment option named ${s(j)}, if present, must have a corresponding string value, got ${s(E)}`),u=E}}return r(u===void 0||typeof u=="string",v`Environment option value ${s(u)}, if present, must be a string.`),u};c(S);let g=()=>c(h(O));return c(g),{getEnvironmentOption:S,getCapturedEnvironmentOptionNames:g}};a.makeEnvironmentCaptor(m),c(m)},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s,m,w,O,S,g;i([["../commons.js",[["WeakSet",[y=>d=y]],["arrayFilter",[y=>h=y]],["arrayMap",[y=>c=y]],["arrayPush",[y=>r=y]],["defineProperty",[y=>v=y]],["freeze",[y=>s=y]],["fromEntries",[y=>m=y]],["isError",[y=>w=y]],["stringEndsWith",[y=>O=y]],["weaksetAdd",[y=>S=y]],["weaksetHas",[y=>g=y]]]],["./types.js",[]],["./internal-types.js",[]]]);let j=s([["debug","debug"],["log","log"],["info","info"],["warn","warn"],["error","error"],["trace","log"],["dirxml","log"],["group","log"],["groupCollapsed","log"]]),b=s([["assert","error"],["timeLog","log"],["clear",void 0],["count","info"],["countReset",void 0],["dir","log"],["groupEnd","log"],["table","log"],["time","info"],["timeEnd","info"],["profile",void 0],["profileEnd",void 0],["timeStamp",void 0]]),u=s([...j,...b]);a.consoleWhitelist(u);let k=(y,{shouldResetForDebugging:D=!1}={})=>{D&&y.resetErrorTagNum();let L=[],T=m(c(u,([F,P])=>{let _=(...N)=>{r(L,[F,...N])};return v(_,"name",{value:F}),[F,s(_)]}));s(T);let x=()=>{let F=s(L);return L=[],F};return s(x),s({loggingConsole:T,takeLog:x})};a.makeLoggingConsoleKit(k),s(k);let f={NOTE:"ERROR_NOTE:",MESSAGE:"ERROR_MESSAGE:"};s(f);let E=(y,D)=>{let{getStackString:L,tagError:T,takeMessageLogArgs:x,takeNoteLogArgsArray:F}=D,P=(U,A)=>c(U,z=>w(z)?(r(A,z),`(${T(z)})`):z),_=(U,A,z,J,B)=>{let K=T(A),M=z===f.MESSAGE?K+":":`${K} ${z}`,Q=P(J,B);y[U](M,...Q)},N=(U,A,z)=>{if(A.length===0)return;if(A.length===1&&z===void 0)return void H(U,A[0]);let J;J=A.length===1?"Nested error":`Nested ${A.length} errors`,z!==void 0&&(J=`${J} under ${z}`),y.group(J);try{for(let B of A)H(U,B)}finally{y.groupEnd()}},G=new d,H=(U,A)=>{if(g(G,A))return;let z=T(A);S(G,A);let J=[],B=x(A),K=F(A,(Q=>(R,q)=>{let $=[];_(Q,R,f.NOTE,q,$),N(Q,$,T(R))})(U));B===void 0?y[U](z+":",A.message):_(U,A,f.MESSAGE,B,J);let M=L(A);typeof M=="string"&&M.length>=1&&!O(M,`
`)&&(M+=`
`),y[U](M);for(let Q of K)_(U,A,f.NOTE,Q,J);N(U,J,z)},V=c(j,([U,A])=>{let z=(...J)=>{let B=[],K=P(J,B);y[U](...K),N(U,B)};return v(z,"name",{value:U}),[U,s(z)]}),C=h(b,([U,A])=>U in y),Y=c(C,([U,A])=>{let z=(...J)=>{y[U](...J)};return v(z,"name",{value:U}),[U,s(z)]}),W=m([...V,...Y]);return s(W)};a.makeCausalConsole(E),s(E);let I=(y,D,L)=>{let T=h(u,([P,_])=>P in y),x=c(T,([P,_])=>[P,s((...N)=>{(_===void 0||D.canLog(_))&&y[P](...N)})]),F=m(x);return s(F)};a.filterConsole(I),s(I)},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s,m,w,O,S,g;i([["../commons.js",[["FinalizationRegistry",[j=>d=j]],["Map",[j=>h=j]],["mapGet",[j=>c=j]],["mapDelete",[j=>r=j]],["WeakMap",[j=>v=j]],["mapSet",[j=>s=j]],["finalizationRegistryRegister",[j=>m=j]],["weakmapSet",[j=>w=j]],["weakmapGet",[j=>O=j]],["mapEntries",[j=>S=j]],["mapHas",[j=>g=j]]]]]),a.makeRejectionHandlers(j=>{if(d===void 0)return;let b=0,u=new h,k,f=y=>{r(u,y),k&&u.size===0&&(k(),k=void 0)},E=new v,I=new d(y=>{if(g(u)){let D=c(u,y);f(y),j(D)}});return{rejectionHandledHandler:y=>{let D=O(E,y);f(D)},unhandledRejectionHandler:(y,D)=>{b+=1;let L=b;s(u,L,y),w(E,D,L),m(I,D,L,D)},processTerminationHandler:()=>{for(let[y,D]of S(u))f(y),j(D)}}})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v;i([["../commons.js",[["TypeError",[m=>d=m]],["globalThis",[m=>h=m]]]],["./assert.js",[["loggedErrorHandler",[m=>c=m]]]],["./console.js",[["makeCausalConsole",[m=>r=m]]]],["./unhandled-rejection.js",[["makeRejectionHandlers",[m=>v=m]]]],["./types.js",[]],["./internal-types.js",[]]]);let s=console;a.tameConsole((m="safe",w="platform",O="report",S)=>{if(m!=="safe"&&m!=="unsafe")throw new d("unrecognized consoleTaming "+m);let g;g=S===void 0?c:{...c,getStackString:S};let j=m==="unsafe"?s:r(s,g);if(w!=="none"&&h.process!==void 0&&h.process.on("uncaughtException",b=>{j.error(b),w==="platform"||w==="exit"?h.process.exit(h.process.exitCode||-1):w==="abort"&&h.process.abort()}),O!=="none"&&h.process!==void 0){let b=v(u=>{j.error("SES_UNHANDLED_REJECTION:",u)});b&&(h.process.on("unhandledRejection",b.unhandledRejectionHandler),h.process.on("rejectionHandled",b.rejectionHandledHandler),h.process.on("exit",b.processTerminationHandler))}if(w!=="none"&&h.window!==void 0&&h.window.addEventListener!==void 0&&h.window.addEventListener("error",b=>{b.preventDefault(),j.error(b.error),w!=="exit"&&w!=="abort"||(h.window.location.href="about:blank")}),O!=="none"&&h.window!==void 0&&h.window.addEventListener!==void 0){let b=v(u=>{j.error("SES_UNHANDLED_REJECTION:",u)});b&&(h.window.addEventListener("unhandledrejection",u=>{u.preventDefault(),b.unhandledRejectionHandler(u.reason,u.promise)}),h.window.addEventListener("rejectionhandled",u=>{u.preventDefault(),b.rejectionHandledHandler(u.promise)}),h.window.addEventListener("beforeunload",u=>{b.processTerminationHandler()}))}return{console:j}})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s,m,w,O,S,g,j,b,u,k,f,E,I;i([["../commons.js",[["WeakMap",[P=>d=P]],["WeakSet",[P=>h=P]],["apply",[P=>c=P]],["arrayFilter",[P=>r=P]],["arrayJoin",[P=>v=P]],["arrayMap",[P=>s=P]],["arraySlice",[P=>m=P]],["create",[P=>w=P]],["defineProperties",[P=>O=P]],["fromEntries",[P=>S=P]],["reflectSet",[P=>g=P]],["regexpExec",[P=>j=P]],["regexpTest",[P=>b=P]],["weakmapGet",[P=>u=P]],["weakmapHas",[P=>k=P]],["weakmapSet",[P=>f=P]],["weaksetAdd",[P=>E=P]],["weaksetHas",[P=>I=P]]]]]);let y=["getTypeName","getFunctionName","getMethodName","getFileName","getLineNumber","getColumnNumber","getEvalOrigin","isToplevel","isEval","isNative","isConstructor","isAsync","getPosition","getScriptNameOrSourceURL","toString"],D=P=>{let _=S(s(y,N=>{let G=P[N];return[N,()=>c(G,P,[])]}));return w(_,{})},L=[/\/node_modules\//,/^(?:node:)?internal\//,/\/packages\/ses\/src\/error\/assert.js$/,/\/packages\/eventual-send\/src\//],T=P=>{if(!P)return!0;for(let _ of L)if(b(_,P))return!1;return!0};a.filterFileName(T);let x=[/^((?:.*[( ])?)[:/\w_-]*\/\.\.\.\/(.+)$/,/^((?:.*[( ])?)[:/\w_-]*\/(packages\/.+)$/],F=P=>{for(let _ of x){let N=j(_,P);if(N)return v(m(N,1),"")}return P};a.shortenCallSiteString(F),a.tameV8ErrorConstructor((P,_,N,G)=>{let H=P.captureStackTrace,V=B=>G==="verbose"||T(B.getFileName()),C=B=>{let K=""+B;return G==="concise"&&(K=F(K)),`
  at `+K},Y=(B,K)=>v(s(r(K,V),C),""),W=new d,U={captureStackTrace(B,K=U.captureStackTrace){typeof H!="function"?g(B,"stack",""):c(H,P,[B,K])},getStackString(B){k(W,B)||B.stack;let K=u(W,B);return K?Y(0,K):""},prepareStackTrace(B,K){return f(W,B,K),N==="unsafe"?`${B}${Y(0,K)}`:""}},A=U.prepareStackTrace;P.prepareStackTrace=A;let z=new h([A]),J=B=>{if(I(z,B))return B;let K={prepareStackTrace:(M,Q)=>(f(W,M,Q),B(M,(R=>s(R,D))(Q)))};return E(z,K.prepareStackTrace),K.prepareStackTrace};return O(_,{captureStackTrace:{value:U.captureStackTrace,writable:!0,enumerable:!1,configurable:!0},prepareStackTrace:{get:()=>P.prepareStackTrace,set(B){if(typeof B=="function"){let K=J(B);P.prepareStackTrace=K}else P.prepareStackTrace=A},enumerable:!1,configurable:!0}}),U.getStackString})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s,m,w,O;i([["../commons.js",[["FERAL_ERROR",[b=>d=b]],["TypeError",[b=>h=b]],["apply",[b=>c=b]],["construct",[b=>r=b]],["defineProperties",[b=>v=b]],["setPrototypeOf",[b=>s=b]],["getOwnPropertyDescriptor",[b=>m=b]]]],["../whitelist.js",[["NativeErrors",[b=>w=b]]]],["./tame-v8-error-constructor.js",[["tameV8ErrorConstructor",[b=>O=b]]]]]);let S=m(d.prototype,"stack"),g=S&&S.get,j={getStackString:b=>typeof g=="function"?c(g,b,[]):"stack"in b?""+b.stack:""};a.default(function(b="safe",u="concise"){if(b!=="safe"&&b!=="unsafe")throw new h("unrecognized errorTaming "+b);if(u!=="concise"&&u!=="verbose")throw new h("unrecognized stackFiltering "+u);let k=d.prototype,f=typeof d.captureStackTrace=="function"?"v8":"unknown",{captureStackTrace:E}=d,I=(T={})=>{let x=function(...F){let P;return P=new.target===void 0?c(d,this,F):r(d,F,new.target),f==="v8"&&c(E,d,[P,x]),P};return v(x,{length:{value:1},prototype:{value:k,writable:!1,enumerable:!1,configurable:!1}}),x},y=I({powers:"original"}),D=I({powers:"none"});v(k,{constructor:{value:D}});for(let T of w)s(T,D);v(y,{stackTraceLimit:{get(){if(typeof d.stackTraceLimit=="number")return d.stackTraceLimit},set(T){typeof T=="number"&&(typeof d.stackTraceLimit!="number"||(d.stackTraceLimit=T))},enumerable:!1,configurable:!0}}),v(D,{stackTraceLimit:{get(){},set(T){},enumerable:!1,configurable:!0}});let L=j.getStackString;return f==="v8"?L=O(d,y,b,u):v(k,b==="unsafe"?{stack:{get(){return L(this)},set(T){v(this,{stack:{value:T,writable:!0,enumerable:!0,configurable:!0}})}}}:{stack:{get(){return""+this},set(T){v(this,{stack:{value:T,writable:!0,enumerable:!0,configurable:!0}})}}}),{"%InitialGetStackString%":L,"%InitialError%":y,"%SharedError%":D}})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s,m,w,O,S,g,j,b,u,k;function f(E){return m(E).constructor}i([["./commons.js",[["FERAL_FUNCTION",[E=>d=E]],["Float32Array",[E=>h=E]],["Map",[E=>c=E]],["Set",[E=>r=E]],["String",[E=>v=E]],["getOwnPropertyDescriptor",[E=>s=E]],["getPrototypeOf",[E=>m=E]],["iterateArray",[E=>w=E]],["iterateMap",[E=>O=E]],["iterateSet",[E=>S=E]],["iterateString",[E=>g=E]],["matchAllRegExp",[E=>j=E]],["matchAllSymbol",[E=>b=E]],["regexpPrototype",[E=>u=E]]]],["./compartment-shim.js",[["InertCompartment",[E=>k=E]]]]]),a.getAnonymousIntrinsics(()=>{let E=d.prototype.constructor,I=s(function(){return arguments}(),"callee").get,y=g(new v),D=m(y),L=u[b]&&j(/./),T=L&&m(L),x=w([]),F=m(x),P=m(h),_=O(new c),N=m(_),G=S(new r),H=m(G),V=m(F),C=f(function*(){}),Y=C.prototype,W=f(async function*(){}),U=W.prototype,A=U.prototype,z=m(A);return{"%InertFunction%":E,"%ArrayIteratorPrototype%":F,"%InertAsyncFunction%":f(async function(){}),"%AsyncGenerator%":U,"%InertAsyncGeneratorFunction%":W,"%AsyncGeneratorPrototype%":A,"%AsyncIteratorPrototype%":z,"%Generator%":Y,"%InertGeneratorFunction%":C,"%IteratorPrototype%":V,"%MapIteratorPrototype%":N,"%RegExpStringIteratorPrototype%":T,"%SetIteratorPrototype%":H,"%StringIteratorPrototype%":D,"%ThrowTypeError%":I,"%TypedArray%":P,"%InertCompartment%":k}})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s,m,w,O,S,g,j,b,u,k,f,E,I,y,D,L,T,x,F,P,_,N;i([["./commons.js",[["Set",[C=>d=C]],["String",[C=>h=C]],["TypeError",[C=>c=C]],["WeakMap",[C=>r=C]],["WeakSet",[C=>v=C]],["apply",[C=>s=C]],["arrayForEach",[C=>m=C]],["defineProperty",[C=>w=C]],["freeze",[C=>O=C]],["getOwnPropertyDescriptor",[C=>S=C]],["getOwnPropertyDescriptors",[C=>g=C]],["getPrototypeOf",[C=>j=C]],["isInteger",[C=>b=C]],["isObject",[C=>u=C]],["objectHasOwnProperty",[C=>k=C]],["ownKeys",[C=>f=C]],["preventExtensions",[C=>E=C]],["setAdd",[C=>I=C]],["setForEach",[C=>y=C]],["setHas",[C=>D=C]],["toStringTagSymbol",[C=>L=C]],["typedArrayPrototype",[C=>T=C]],["weakmapGet",[C=>x=C]],["weakmapSet",[C=>F=C]],["weaksetAdd",[C=>P=C]],["weaksetHas",[C=>_=C]]]],["./error/assert.js",[["assert",[C=>N=C]]]]]);let G=S(T,L);N(G);let H=G.get;N(H);let V=C=>s(H,C,[])!==void 0;a.isTypedArray(V),a.makeHardener(()=>{let C=new v,{harden:Y}={harden(W){let U=new d,A=new r;function z(K,M){if(!u(K))return;let Q=typeof K;if(Q!=="object"&&Q!=="function")throw new c("Unexpected typeof: "+Q);_(C,K)||D(U,K)||(I(U,K),F(A,K,M))}function J(K){V(K)?(R=>{let q=g(R);E(R),m(f(q),$=>{let Z=q[$],ee=+h($);b(ee)||w(R,$,{...Z,writable:!1,configurable:!1})})})(K):O(K);let M=x(A,K)||"unknown",Q=g(K);z(j(K),M+".__proto__"),m(f(Q),R=>{let q=`${M}.${h(R)}`,$=Q[R];k($,"value")?z($.value,""+q):(z($.get,q+"(get)"),z($.set,q+"(set)"))})}function B(K){P(C,K)}return z(W),y(U,J),y(U,B),W}};return Y})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v;i([["./commons.js",[["Date",[s=>d=s]],["TypeError",[s=>h=s]],["apply",[s=>c=s]],["construct",[s=>r=s]],["defineProperties",[s=>v=s]]]]]),a.default(function(s="safe"){if(s!=="safe"&&s!=="unsafe")throw new h("unrecognized dateTaming "+s);let m=d,w=m.prototype,O={now:()=>NaN},S=({powers:b="none"}={})=>{let u;return u=b==="original"?function(...k){return new.target===void 0?c(m,void 0,k):r(m,k,new.target)}:function(...k){return new.target===void 0?"Invalid Date":(k.length===0&&(k=[NaN]),r(m,k,new.target))},v(u,{length:{value:7},prototype:{value:w,writable:!1,enumerable:!1,configurable:!1},parse:{value:d.parse,writable:!0,enumerable:!1,configurable:!0},UTC:{value:d.UTC,writable:!0,enumerable:!1,configurable:!0}}),u},g=S({powers:"original"}),j=S({powers:"none"});return v(g,{now:{value:d.now,writable:!0,enumerable:!1,configurable:!0}}),v(j,{now:{value:O.now,writable:!0,enumerable:!1,configurable:!0}}),v(w,{constructor:{value:j}}),{"%InitialDate%":g,"%SharedDate%":j}})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r;function v(s="safe"){if(s!=="safe"&&s!=="unsafe")throw new d("unrecognized domainTaming "+s);if(s!=="unsafe"&&typeof h.process=="object"&&h.process!==null){let m=c(h.process,"domain");if(m!==void 0&&m.get!==void 0)throw new d("SES failed to lockdown, Node.js domains have been initialized (SES_NO_DOMAINS)");r(h.process,"domain",{value:null,configurable:!1,writable:!1,enumerable:!1})}}i([["./commons.js",[["TypeError",[s=>d=s]],["globalThis",[s=>h=s]],["getOwnPropertyDescriptor",[s=>c=s]],["defineProperty",[s=>r=s]]]]]),Object.defineProperty(v,"name",{value:"tameDomains"}),a.tameDomains(v)},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s;i([["./commons.js",[["FERAL_FUNCTION",[m=>d=m]],["SyntaxError",[m=>h=m]],["TypeError",[m=>c=m]],["defineProperties",[m=>r=m]],["getPrototypeOf",[m=>v=m]],["setPrototypeOf",[m=>s=m]]]]]),a.default(function(){try{d.prototype.constructor("return 1")}catch{return{}}let m={};function w(O,S,g){let j;try{j=(0,eval)(g)}catch(k){if(k instanceof h)return;throw k}let b=v(j),u=function(){throw new c("Function.prototype.constructor is not a valid constructor.")};r(u,{prototype:{value:b},name:{value:O,writable:!1,enumerable:!1,configurable:!0}}),r(b,{constructor:{value:u}}),u!==d.prototype.constructor&&s(u,d.prototype.constructor),m[S]=u}return w("Function","%InertFunction%","(function(){})"),w("GeneratorFunction","%InertGeneratorFunction%","(function*(){})"),w("AsyncFunction","%InertAsyncFunction%","(async function(){})"),w("AsyncGeneratorFunction","%InertAsyncGeneratorFunction%","(async function*(){})"),m})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s,m,w;i([["./commons.js",[["WeakSet",[S=>d=S]],["defineProperty",[S=>h=S]],["freeze",[S=>c=S]],["functionPrototype",[S=>r=S]],["functionToString",[S=>v=S]],["stringEndsWith",[S=>s=S]],["weaksetAdd",[S=>m=S]],["weaksetHas",[S=>w=S]]]]]);let O;a.tameFunctionToString(()=>{if(O===void 0){let S=new d;h(r,"toString",{value:{toString(){let g=v(this,[]);return s(g,") { [native code] }")||!w(S,this)?g:`function ${this.name}() { [native code] }`}}.toString}),O=c(g=>m(S,g))}return O})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s,m,w;i([["./commons.js",[["Number",[k=>d=k]],["String",[k=>h=k]],["TypeError",[k=>c=k]],["defineProperty",[k=>r=k]],["getOwnPropertyNames",[k=>v=k]],["isObject",[k=>s=k]],["regexpExec",[k=>m=k]]]],["./error/assert.js",[["assert",[k=>w=k]]]]]);let{details:O,quote:S}=w,g=/^(\w*[a-z])Locale([A-Z]\w*)$/,j={localeCompare(k){if(this==null)throw new c('Cannot localeCompare with null or undefined "this" value');let f=""+this;return f<(k=""+k)?-1:f>k?1:(w(f===k,O`expected ${S(f)} and ${S(k)} to compare`),0)},toString(){return""+this}},b=j.localeCompare,u=j.toString;a.default(function(k,f="safe"){if(f!=="safe"&&f!=="unsafe")throw new c("unrecognized localeTaming "+f);if(f!=="unsafe"){r(h.prototype,"localeCompare",{value:b});for(let E of v(k)){let I=k[E];if(s(I))for(let y of v(I)){let D=m(g,y);if(D){w(typeof I[y]=="function",O`expected ${S(y)} to be a function`);let L=`${D[1]}${D[2]}`,T=I[L];w(typeof T=="function",O`function ${S(L)} not found`),r(I,y,{value:T})}}}r(d.prototype,"toLocaleString",{value:u})}})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v;i([["./commons.js",[["Math",[s=>d=s]],["TypeError",[s=>h=s]],["create",[s=>c=s]],["getOwnPropertyDescriptors",[s=>r=s]],["objectPrototype",[s=>v=s]]]]]),a.default(function(s="safe"){if(s!=="safe"&&s!=="unsafe")throw new h("unrecognized mathTaming "+s);let m=d,w=m,{random:O,...S}=r(m);return{"%InitialMath%":w,"%SharedMath%":c(v,S)}})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s;i([["./commons.js",[["FERAL_REG_EXP",[m=>d=m]],["TypeError",[m=>h=m]],["construct",[m=>c=m]],["defineProperties",[m=>r=m]],["getOwnPropertyDescriptor",[m=>v=m]],["speciesSymbol",[m=>s=m]]]]]),a.default(function(m="safe"){if(m!=="safe"&&m!=="unsafe")throw new h("unrecognized regExpTaming "+m);let w=d.prototype,O=(j={})=>{let b=function(...u){return new.target===void 0?d(...u):c(d,u,new.target)};return r(b,{length:{value:2},prototype:{value:w,writable:!1,enumerable:!1,configurable:!1},[s]:v(d,s)}),b},S=O(),g=O();return m!=="unsafe"&&delete w.compile,r(w,{constructor:{value:g}}),{"%InitialRegExp%":S,"%SharedRegExp%":g}})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s,m,w,O,S,g,j,b,u,k,f,E;i([["./whitelist.js",[["whitelist",[I=>d=I]],["FunctionInstance",[I=>h=I]],["isAccessorPermit",[I=>c=I]]]],["./commons.js",[["Map",[I=>r=I]],["String",[I=>v=I]],["TypeError",[I=>s=I]],["arrayFilter",[I=>m=I]],["arrayIncludes",[I=>w=I]],["arrayMap",[I=>O=I]],["entries",[I=>S=I]],["getOwnPropertyDescriptor",[I=>g=I]],["getPrototypeOf",[I=>j=I]],["isObject",[I=>b=I]],["mapGet",[I=>u=I]],["objectHasOwnProperty",[I=>k=I]],["ownKeys",[I=>f=I]],["symbolKeyFor",[I=>E=I]]]]]),a.default(function(I,y){let D=["undefined","boolean","number","string","symbol"],L=new r(I.Symbol?O(m(S(d.Symbol),([N,G])=>G==="symbol"&&typeof I.Symbol[N]=="symbol"),([N])=>[I.Symbol[N],"@@"+N]):[]);function T(N,G){if(typeof G=="string")return G;let H=u(L,G);if(typeof G=="symbol"){if(H)return H;{let V=E(G);return V!==void 0?`RegisteredSymbol(${V})`:"Unique"+v(G)}}throw new s(`Unexpected property name type ${N} ${G}`)}function x(N,G,H,V){if(typeof V=="object")return _(N,G,V),!0;if(V===!1)return!1;if(typeof V=="string"){if(H==="prototype"||H==="constructor"){if(k(I,V)){if(G!==I[V])throw new s("Does not match whitelist "+N);return!0}}else if(w(D,V)){if(typeof G!==V)throw new s(`At ${N} expected ${V} not ${typeof G}`);return!0}}throw new s(`Unexpected whitelist permit ${V} at ${N}`)}function F(N,G,H,V){let C=g(G,H);if(k(C,"value")){if(c(V))throw new s("Accessor expected at "+N);return x(N,C.value,H,V)}if(!c(V))throw new s("Accessor not expected at "+N);return x(N+"<get>",C.get,H,V.get)&&x(N+"<set>",C.set,H,V.set)}function P(N,G,H){let V=H==="__proto__"?"--proto--":H;return k(G,V)?G[V]:typeof N=="function"&&(y(N),k(h,V))?h[V]:void 0}function _(N,G,H){if(G!==void 0){(function(V,C,Y){if(!b(C))throw new s(`Object expected: ${V}, ${C}, ${Y}`);let W=j(C);if(W!==null||Y!==null){if(Y!==void 0&&typeof Y!="string")throw new s(`Malformed whitelist permit ${V}.__proto__`);if(W!==I[Y||"%ObjectPrototype%"])throw new s(`Unexpected intrinsic ${V}.__proto__ at ${Y}`)}})(N,G,H["[[Proto]]"]);for(let V of f(G)){let C=T(N,V),Y=`${N}.${C}`,W=P(G,H,C);if(!W||!F(Y,G,V,W)){W!==!1&&console.warn("Removing "+Y);try{delete G[V]}catch(U){throw V in G?console.error("failed to delete "+Y,U):console.error(`deleting ${Y} threw`,U),U}}}}}_("intrinsics",I,d)})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s,m,w,O,S,g,j,b,u,k,f,E,I,y,D,L,T,x,F,P,_,N,G,H,V,C,Y,W,U;i([["./commons.js",[["FERAL_FUNCTION",[M=>d=M]],["FERAL_EVAL",[M=>h=M]],["TypeError",[M=>c=M]],["arrayFilter",[M=>r=M]],["arrayMap",[M=>v=M]],["globalThis",[M=>s=M]],["is",[M=>m=M]],["ownKeys",[M=>w=M]],["stringSplit",[M=>O=M]],["noEvalEvaluate",[M=>S=M]]]],["./error/stringify-utils.js",[["enJoin",[M=>g=M]]]],["./make-hardener.js",[["makeHardener",[M=>j=M]]]],["./intrinsics.js",[["makeIntrinsicsCollector",[M=>b=M]]]],["./whitelist-intrinsics.js",[["default",[M=>u=M]]]],["./tame-function-constructors.js",[["default",[M=>k=M]]]],["./tame-date-constructor.js",[["default",[M=>f=M]]]],["./tame-math-object.js",[["default",[M=>E=M]]]],["./tame-regexp-constructor.js",[["default",[M=>I=M]]]],["./enable-property-overrides.js",[["default",[M=>y=M]]]],["./tame-locale-methods.js",[["default",[M=>D=M]]]],["./global-object.js",[["setGlobalObjectConstantProperties",[M=>L=M]],["setGlobalObjectMutableProperties",[M=>T=M]],["setGlobalObjectEvaluators",[M=>x=M]]]],["./make-safe-evaluator.js",[["makeSafeEvaluator",[M=>F=M]]]],["./whitelist.js",[["initialGlobalPropertyNames",[M=>P=M]]]],["./tame-function-tostring.js",[["tameFunctionToString",[M=>_=M]]]],["./tame-domains.js",[["tameDomains",[M=>N=M]]]],["./error/tame-console.js",[["tameConsole",[M=>G=M]]]],["./error/tame-error-constructor.js",[["default",[M=>H=M]]]],["./error/assert.js",[["assert",[M=>V=M]],["makeAssert",[M=>C=M]]]],["./environment-options.js",[["makeEnvironmentCaptor",[M=>Y=M]]]],["./get-anonymous-intrinsics.js",[["getAnonymousIntrinsics",[M=>W=M]]]],["./compartment-shim.js",[["makeCompartmentConstructor",[M=>U=M]]]]]);let{details:A,quote:z}=V,J,B=j(),K=(M={})=>{let{getEnvironmentOption:Q,getCapturedEnvironmentOptionNames:R}=Y(s),{errorTaming:q=Q("LOCKDOWN_ERROR_TAMING","safe"),errorTrapping:$=Q("LOCKDOWN_ERROR_TRAPPING","platform"),unhandledRejectionTrapping:Z=Q("LOCKDOWN_UNHANDLED_REJECTION_TRAPPING","report"),regExpTaming:ee=Q("LOCKDOWN_REGEXP_TAMING","safe"),localeTaming:ie=Q("LOCKDOWN_LOCALE_TAMING","safe"),consoleTaming:ae=Q("LOCKDOWN_CONSOLE_TAMING","safe"),overrideTaming:se=Q("LOCKDOWN_OVERRIDE_TAMING","moderate"),stackFiltering:te=Q("LOCKDOWN_STACK_FILTERING","concise"),domainTaming:re=Q("LOCKDOWN_DOMAIN_TAMING","safe"),evalTaming:oe=Q("LOCKDOWN_EVAL_TAMING","safeEval"),overrideDebug:le=r(O(Q("LOCKDOWN_OVERRIDE_DEBUG",""),","),fe=>fe!==""),__allowUnsafeMonkeyPatching__:me=Q("__LOCKDOWN_ALLOW_UNSAFE_MONKEY_PATCHING__","safe"),dateTaming:pe="safe",mathTaming:ue="safe",...he}=M,ce=R();ce.length>0&&console.warn("SES Lockdown using options from environment variables "+g(v(ce,z),"and")),V(oe==="unsafeEval"||oe==="safeEval"||oe==="noEval",A`lockdown(): non supported option evalTaming: ${z(oe)}`);let be=w(he);if(V(be.length===0,A`lockdown(): non supported option ${z(be)}`),V(J===void 0,`Already locked down at ${J} (SES_ALREADY_LOCKED_DOWN)`,c),J=new c("Prior lockdown (SES_ALREADY_LOCKED_DOWN)"),J.stack,(()=>{let fe=!1;try{fe=d("eval","SES_changed",`        eval("SES_changed = true");
        return SES_changed;
      `)(h,!1),fe||delete s.SES_changed}catch{fe=!0}if(!fe)throw new c("SES cannot initialize unless 'eval' is the original intrinsic 'eval', suitable for direct-eval (dynamically scoped eval) (SES_DIRECT_EVAL)")})(),s.Function.prototype.constructor!==s.Function&&typeof s.harden=="function"&&typeof s.lockdown=="function"&&s.Date.prototype.constructor!==s.Date&&typeof s.Date.now=="function"&&m(s.Date.prototype.constructor.now(),NaN))throw new c("Already locked down but not by this SES instance (SES_MULTIPLE_INSTANCES)");N(re);let{addIntrinsics:ve,completePrototypes:ge,finalIntrinsics:we}=b();ve({harden:B}),ve(k()),ve(f(pe)),ve(H(q,te)),ve(E(ue)),ve(I(ee)),ve(W()),ge();let Ee=we(),ke;q!=="unsafe"&&(ke=Ee["%InitialGetStackString%"]);let Se=G(ae,$,Z,ke);s.console=Se.console,q==="unsafe"&&s.assert===V&&(s.assert=C(void 0,!0)),D(Ee,ie);let de=_();if(u(Ee,de),L(s),T(s,{intrinsics:Ee,newGlobalPropertyNames:P,makeCompartmentConstructor:U,markVirtualizedNativeFunction:de}),oe==="noEval")x(s,S,de);else if(oe==="safeEval"){let{safeEvaluate:fe}=F({globalObject:s});x(s,fe,de)}return function(){return y(Ee,se,le),me!=="unsafe"&&B(Ee),s.harden=B,!0}};a.repairIntrinsics(K),a.lockdown((M={})=>{K(M)()})},({imports:i,liveVar:p,onceVar:a})=>{let d,h,c,r,v,s,m,w;if(i([["./src/commons.js",[["globalThis",[g=>d=g]],["TypeError",[g=>h=g]],["assign",[g=>c=g]]]],["./src/tame-function-tostring.js",[["tameFunctionToString",[g=>r=g]]]],["./src/intrinsics.js",[["getGlobalIntrinsics",[g=>v=g]]]],["./src/lockdown-shim.js",[["lockdown",[g=>s=g]]]],["./src/compartment-shim.js",[["makeCompartmentConstructor",[g=>m=g]]]],["./src/error/assert.js",[["assert",[g=>w=g]]]]]),function(){return this}())throw new h("SES failed to initialize, sloppy mode (SES_NO_SLOPPY)");let O=r(),S=m(m,v(d),O);c(d,{lockdown:s,Compartment:S,assert:w})}];function e(i,p){let a=[];return{get:function(){return p},set:function(d){p=d;for(let h of a)h(p)},observe:function(d){a.push(d),d(p)},enumerable:!0}}let o=[{globalThis:e(),Array:e(),Date:e(),FinalizationRegistry:e(),Float32Array:e(),JSON:e(),Map:e(),Math:e(),Number:e(),Object:e(),Promise:e(),Proxy:e(),Reflect:e(),FERAL_REG_EXP:e(),Set:e(),String:e(),WeakMap:e(),WeakSet:e(),FERAL_ERROR:e(),RangeError:e(),ReferenceError:e(),SyntaxError:e(),TypeError:e(),assign:e(),create:e(),defineProperties:e(),entries:e(),freeze:e(),getOwnPropertyDescriptor:e(),getOwnPropertyDescriptors:e(),getOwnPropertyNames:e(),getPrototypeOf:e(),is:e(),isExtensible:e(),keys:e(),objectPrototype:e(),seal:e(),preventExtensions:e(),setPrototypeOf:e(),values:e(),speciesSymbol:e(),toStringTagSymbol:e(),iteratorSymbol:e(),matchAllSymbol:e(),symbolKeyFor:e(),symbolFor:e(),isInteger:e(),stringifyJson:e(),fromEntries:e(),defineProperty:e(),apply:e(),construct:e(),reflectGet:e(),reflectGetOwnPropertyDescriptor:e(),reflectHas:e(),reflectIsExtensible:e(),ownKeys:e(),reflectPreventExtensions:e(),reflectSet:e(),isArray:e(),arrayPrototype:e(),mapPrototype:e(),proxyRevocable:e(),regexpPrototype:e(),setPrototype:e(),stringPrototype:e(),weakmapPrototype:e(),weaksetPrototype:e(),functionPrototype:e(),promisePrototype:e(),typedArrayPrototype:e(),uncurryThis:e(),objectHasOwnProperty:e(),arrayFilter:e(),arrayForEach:e(),arrayIncludes:e(),arrayJoin:e(),arrayMap:e(),arrayPop:e(),arrayPush:e(),arraySlice:e(),arraySome:e(),arraySort:e(),iterateArray:e(),mapSet:e(),mapGet:e(),mapHas:e(),mapDelete:e(),mapEntries:e(),iterateMap:e(),setAdd:e(),setDelete:e(),setForEach:e(),setHas:e(),iterateSet:e(),regexpTest:e(),regexpExec:e(),matchAllRegExp:e(),stringEndsWith:e(),stringIncludes:e(),stringIndexOf:e(),stringMatch:e(),stringReplace:e(),stringSearch:e(),stringSlice:e(),stringSplit:e(),stringStartsWith:e(),iterateString:e(),weakmapDelete:e(),weakmapGet:e(),weakmapHas:e(),weakmapSet:e(),weaksetAdd:e(),weaksetGet:e(),weaksetHas:e(),functionToString:e(),promiseAll:e(),promiseCatch:e(),promiseThen:e(),finalizationRegistryRegister:e(),finalizationRegistryUnregister:e(),getConstructorOf:e(),immutableObject:e(),isObject:e(),isError:e(),FERAL_EVAL:e(),FERAL_FUNCTION:e(),noEvalEvaluate:e()},{},{an:e(),bestEffortStringify:e(),enJoin:e()},{},{unredactedDetails:e(),loggedErrorHandler:e(),makeAssert:e(),assert:e()},{makeEvaluateFactory:e()},{isValidIdentifierName:e(),getScopeConstants:e()},{createScopeHandler:e()},{getSourceURL:e()},{rejectHtmlComments:e(),evadeHtmlCommentTest:e(),rejectImportExpressions:e(),evadeImportExpressionTest:e(),rejectSomeDirectEvalExpressions:e(),mandatoryTransforms:e(),applyTransforms:e()},{makeSafeEvaluator:e()},{provideCompartmentEvaluator:e(),compartmentEvaluate:e()},{makeEvalFunction:e()},{makeFunctionConstructor:e()},{constantProperties:e(),universalPropertyNames:e(),initialGlobalPropertyNames:e(),sharedGlobalPropertyNames:e(),uniqueGlobalPropertyNames:e(),NativeErrors:e(),FunctionInstance:e(),isAccessorPermit:e(),whitelist:e()},{setGlobalObjectConstantProperties:e(),setGlobalObjectMutableProperties:e(),setGlobalObjectEvaluators:e()},{makeAlias:e(),load:e()},{deferExports:e(),getDeferredExports:e()},{makeThirdPartyModuleInstance:e(),makeModuleInstance:e()},{link:e(),instantiate:e()},{InertCompartment:e(),CompartmentPrototype:e(),makeCompartmentConstructor:e()},{makeIntrinsicsCollector:e(),getGlobalIntrinsics:e()},{minEnablements:e(),moderateEnablements:e(),severeEnablements:e()},{default:e()},{makeEnvironmentCaptor:e()},{makeLoggingConsoleKit:e(),makeCausalConsole:e(),filterConsole:e(),consoleWhitelist:e()},{makeRejectionHandlers:e()},{tameConsole:e()},{filterFileName:e(),shortenCallSiteString:e(),tameV8ErrorConstructor:e()},{default:e()},{getAnonymousIntrinsics:e()},{isTypedArray:e(),makeHardener:e()},{default:e()},{tameDomains:e()},{default:e()},{tameFunctionToString:e()},{default:e()},{default:e()},{default:e()},{default:e()},{repairIntrinsics:e(),lockdown:e()},{}],l=o.map(i=>Object.create(null,i));for(let i=0;i<l.length;i+=1)o[i]["*"]=e(0,l[i]);function n(i,p,a){for(let[d,h]of i.get(p)){let c=o[a][d];if(c===void 0)throw new ReferenceError("Cannot import name "+d);for(let r of h)c.observe(r)}}t[0]({imports(i){new Map(i)},liveVar:{},onceVar:{universalThis:o[0].globalThis.set,Array:o[0].Array.set,Date:o[0].Date.set,FinalizationRegistry:o[0].FinalizationRegistry.set,Float32Array:o[0].Float32Array.set,JSON:o[0].JSON.set,Map:o[0].Map.set,Math:o[0].Math.set,Number:o[0].Number.set,Object:o[0].Object.set,Promise:o[0].Promise.set,Proxy:o[0].Proxy.set,Reflect:o[0].Reflect.set,FERAL_REG_EXP:o[0].FERAL_REG_EXP.set,Set:o[0].Set.set,String:o[0].String.set,WeakMap:o[0].WeakMap.set,WeakSet:o[0].WeakSet.set,FERAL_ERROR:o[0].FERAL_ERROR.set,RangeError:o[0].RangeError.set,ReferenceError:o[0].ReferenceError.set,SyntaxError:o[0].SyntaxError.set,TypeError:o[0].TypeError.set,assign:o[0].assign.set,create:o[0].create.set,defineProperties:o[0].defineProperties.set,entries:o[0].entries.set,freeze:o[0].freeze.set,getOwnPropertyDescriptor:o[0].getOwnPropertyDescriptor.set,getOwnPropertyDescriptors:o[0].getOwnPropertyDescriptors.set,getOwnPropertyNames:o[0].getOwnPropertyNames.set,getPrototypeOf:o[0].getPrototypeOf.set,is:o[0].is.set,isExtensible:o[0].isExtensible.set,keys:o[0].keys.set,objectPrototype:o[0].objectPrototype.set,seal:o[0].seal.set,preventExtensions:o[0].preventExtensions.set,setPrototypeOf:o[0].setPrototypeOf.set,values:o[0].values.set,speciesSymbol:o[0].speciesSymbol.set,toStringTagSymbol:o[0].toStringTagSymbol.set,iteratorSymbol:o[0].iteratorSymbol.set,matchAllSymbol:o[0].matchAllSymbol.set,symbolKeyFor:o[0].symbolKeyFor.set,symbolFor:o[0].symbolFor.set,isInteger:o[0].isInteger.set,stringifyJson:o[0].stringifyJson.set,fromEntries:o[0].fromEntries.set,defineProperty:o[0].defineProperty.set,apply:o[0].apply.set,construct:o[0].construct.set,reflectGet:o[0].reflectGet.set,reflectGetOwnPropertyDescriptor:o[0].reflectGetOwnPropertyDescriptor.set,reflectHas:o[0].reflectHas.set,reflectIsExtensible:o[0].reflectIsExtensible.set,ownKeys:o[0].ownKeys.set,reflectPreventExtensions:o[0].reflectPreventExtensions.set,reflectSet:o[0].reflectSet.set,isArray:o[0].isArray.set,arrayPrototype:o[0].arrayPrototype.set,mapPrototype:o[0].mapPrototype.set,proxyRevocable:o[0].proxyRevocable.set,regexpPrototype:o[0].regexpPrototype.set,setPrototype:o[0].setPrototype.set,stringPrototype:o[0].stringPrototype.set,weakmapPrototype:o[0].weakmapPrototype.set,weaksetPrototype:o[0].weaksetPrototype.set,functionPrototype:o[0].functionPrototype.set,promisePrototype:o[0].promisePrototype.set,typedArrayPrototype:o[0].typedArrayPrototype.set,uncurryThis:o[0].uncurryThis.set,objectHasOwnProperty:o[0].objectHasOwnProperty.set,arrayFilter:o[0].arrayFilter.set,arrayForEach:o[0].arrayForEach.set,arrayIncludes:o[0].arrayIncludes.set,arrayJoin:o[0].arrayJoin.set,arrayMap:o[0].arrayMap.set,arrayPop:o[0].arrayPop.set,arrayPush:o[0].arrayPush.set,arraySlice:o[0].arraySlice.set,arraySome:o[0].arraySome.set,arraySort:o[0].arraySort.set,iterateArray:o[0].iterateArray.set,mapSet:o[0].mapSet.set,mapGet:o[0].mapGet.set,mapHas:o[0].mapHas.set,mapDelete:o[0].mapDelete.set,mapEntries:o[0].mapEntries.set,iterateMap:o[0].iterateMap.set,setAdd:o[0].setAdd.set,setDelete:o[0].setDelete.set,setForEach:o[0].setForEach.set,setHas:o[0].setHas.set,iterateSet:o[0].iterateSet.set,regexpTest:o[0].regexpTest.set,regexpExec:o[0].regexpExec.set,matchAllRegExp:o[0].matchAllRegExp.set,stringEndsWith:o[0].stringEndsWith.set,stringIncludes:o[0].stringIncludes.set,stringIndexOf:o[0].stringIndexOf.set,stringMatch:o[0].stringMatch.set,stringReplace:o[0].stringReplace.set,stringSearch:o[0].stringSearch.set,stringSlice:o[0].stringSlice.set,stringSplit:o[0].stringSplit.set,stringStartsWith:o[0].stringStartsWith.set,iterateString:o[0].iterateString.set,weakmapDelete:o[0].weakmapDelete.set,weakmapGet:o[0].weakmapGet.set,weakmapHas:o[0].weakmapHas.set,weakmapSet:o[0].weakmapSet.set,weaksetAdd:o[0].weaksetAdd.set,weaksetGet:o[0].weaksetGet.set,weaksetHas:o[0].weaksetHas.set,functionToString:o[0].functionToString.set,promiseAll:o[0].promiseAll.set,promiseCatch:o[0].promiseCatch.set,promiseThen:o[0].promiseThen.set,finalizationRegistryRegister:o[0].finalizationRegistryRegister.set,finalizationRegistryUnregister:o[0].finalizationRegistryUnregister.set,getConstructorOf:o[0].getConstructorOf.set,immutableObject:o[0].immutableObject.set,isObject:o[0].isObject.set,isError:o[0].isError.set,FERAL_EVAL:o[0].FERAL_EVAL.set,FERAL_FUNCTION:o[0].FERAL_FUNCTION.set,noEvalEvaluate:o[0].noEvalEvaluate.set}}),t[1]({imports(i){new Map(i)},liveVar:{},onceVar:{}}),t[2]({imports(i){n(new Map(i),"../commons.js",0)},liveVar:{},onceVar:{an:o[2].an.set,bestEffortStringify:o[2].bestEffortStringify.set,enJoin:o[2].enJoin.set}}),t[3]({imports(i){new Map(i)},liveVar:{},onceVar:{}}),t[4]({imports(i){let p=new Map(i);n(p,"../commons.js",0),n(p,"./internal-types.js",1),n(p,"./stringify-utils.js",2),n(p,"./types.js",3)},liveVar:{},onceVar:{unredactedDetails:o[4].unredactedDetails.set,loggedErrorHandler:o[4].loggedErrorHandler.set,makeAssert:o[4].makeAssert.set,assert:o[4].assert.set}}),t[5]({imports(i){n(new Map(i),"./commons.js",0)},liveVar:{},onceVar:{makeEvaluateFactory:o[5].makeEvaluateFactory.set}}),t[6]({imports(i){n(new Map(i),"./commons.js",0)},liveVar:{},onceVar:{isValidIdentifierName:o[6].isValidIdentifierName.set,getScopeConstants:o[6].getScopeConstants.set}}),t[7]({imports(i){let p=new Map(i);n(p,"./commons.js",0),n(p,"./error/assert.js",4)},liveVar:{},onceVar:{createScopeHandler:o[7].createScopeHandler.set}}),t[8]({imports(i){n(new Map(i),"./commons.js",0)},liveVar:{},onceVar:{getSourceURL:o[8].getSourceURL.set}}),t[9]({imports(i){let p=new Map(i);n(p,"./commons.js",0),n(p,"./get-source-url.js",8)},liveVar:{},onceVar:{rejectHtmlComments:o[9].rejectHtmlComments.set,evadeHtmlCommentTest:o[9].evadeHtmlCommentTest.set,rejectImportExpressions:o[9].rejectImportExpressions.set,evadeImportExpressionTest:o[9].evadeImportExpressionTest.set,rejectSomeDirectEvalExpressions:o[9].rejectSomeDirectEvalExpressions.set,mandatoryTransforms:o[9].mandatoryTransforms.set,applyTransforms:o[9].applyTransforms.set}}),t[10]({imports(i){let p=new Map(i);n(p,"./commons.js",0),n(p,"./error/assert.js",4),n(p,"./make-evaluate-factory.js",5),n(p,"./scope-constants.js",6),n(p,"./scope-handler.js",7),n(p,"./transforms.js",9)},liveVar:{},onceVar:{makeSafeEvaluator:o[10].makeSafeEvaluator.set}}),t[11]({imports(i){let p=new Map(i);n(p,"./commons.js",0),n(p,"./make-safe-evaluator.js",10),n(p,"./transforms.js",9)},liveVar:{},onceVar:{provideCompartmentEvaluator:o[11].provideCompartmentEvaluator.set,compartmentEvaluate:o[11].compartmentEvaluate.set}}),t[12]({imports(i){new Map(i)},liveVar:{},onceVar:{makeEvalFunction:o[12].makeEvalFunction.set}}),t[13]({imports(i){let p=new Map(i);n(p,"./commons.js",0),n(p,"./error/assert.js",4)},liveVar:{},onceVar:{makeFunctionConstructor:o[13].makeFunctionConstructor.set}}),t[14]({imports(i){new Map(i)},liveVar:{},onceVar:{constantProperties:o[14].constantProperties.set,universalPropertyNames:o[14].universalPropertyNames.set,initialGlobalPropertyNames:o[14].initialGlobalPropertyNames.set,sharedGlobalPropertyNames:o[14].sharedGlobalPropertyNames.set,uniqueGlobalPropertyNames:o[14].uniqueGlobalPropertyNames.set,NativeErrors:o[14].NativeErrors.set,FunctionInstance:o[14].FunctionInstance.set,isAccessorPermit:o[14].isAccessorPermit.set,whitelist:o[14].whitelist.set}}),t[15]({imports(i){let p=new Map(i);n(p,"./commons.js",0),n(p,"./make-eval-function.js",12),n(p,"./make-function-constructor.js",13),n(p,"./whitelist.js",14)},liveVar:{},onceVar:{setGlobalObjectConstantProperties:o[15].setGlobalObjectConstantProperties.set,setGlobalObjectMutableProperties:o[15].setGlobalObjectMutableProperties.set,setGlobalObjectEvaluators:o[15].setGlobalObjectEvaluators.set}}),t[16]({imports(i){let p=new Map(i);n(p,"./commons.js",0),n(p,"./error/assert.js",4)},liveVar:{},onceVar:{makeAlias:o[16].makeAlias.set,load:o[16].load.set}}),t[17]({imports(i){let p=new Map(i);n(p,"./commons.js",0),n(p,"./error/assert.js",4),n(p,"./module-load.js",16)},liveVar:{},onceVar:{deferExports:o[17].deferExports.set,getDeferredExports:o[17].getDeferredExports.set}}),t[18]({imports(i){let p=new Map(i);n(p,"./commons.js",0),n(p,"./compartment-evaluate.js",11),n(p,"./error/assert.js",4),n(p,"./module-proxy.js",17)},liveVar:{},onceVar:{makeThirdPartyModuleInstance:o[18].makeThirdPartyModuleInstance.set,makeModuleInstance:o[18].makeModuleInstance.set}}),t[19]({imports(i){let p=new Map(i);n(p,"./commons.js",0),n(p,"./error/assert.js",4),n(p,"./module-instance.js",18)},liveVar:{},onceVar:{link:o[19].link.set,instantiate:o[19].instantiate.set}}),t[20]({imports(i){let p=new Map(i);n(p,"./commons.js",0),n(p,"./compartment-evaluate.js",11),n(p,"./error/assert.js",4),n(p,"./global-object.js",15),n(p,"./make-safe-evaluator.js",10),n(p,"./module-link.js",19),n(p,"./module-load.js",16),n(p,"./module-proxy.js",17),n(p,"./scope-constants.js",6),n(p,"./whitelist.js",14)},liveVar:{},onceVar:{InertCompartment:o[20].InertCompartment.set,CompartmentPrototype:o[20].CompartmentPrototype.set,makeCompartmentConstructor:o[20].makeCompartmentConstructor.set}}),t[21]({imports(i){let p=new Map(i);n(p,"./commons.js",0),n(p,"./whitelist.js",14)},liveVar:{},onceVar:{makeIntrinsicsCollector:o[21].makeIntrinsicsCollector.set,getGlobalIntrinsics:o[21].getGlobalIntrinsics.set}}),t[22]({imports(i){new Map(i)},liveVar:{},onceVar:{minEnablements:o[22].minEnablements.set,moderateEnablements:o[22].moderateEnablements.set,severeEnablements:o[22].severeEnablements.set}}),t[23]({imports(i){let p=new Map(i);n(p,"./commons.js",0),n(p,"./enablements.js",22)},liveVar:{},onceVar:{default:o[23].default.set}}),t[24]({imports(i){let p=new Map(i);n(p,"./commons.js",0),n(p,"./error/assert.js",4)},liveVar:{},onceVar:{makeEnvironmentCaptor:o[24].makeEnvironmentCaptor.set}}),t[25]({imports(i){let p=new Map(i);n(p,"../commons.js",0),n(p,"./internal-types.js",1),n(p,"./types.js",3)},liveVar:{},onceVar:{makeLoggingConsoleKit:o[25].makeLoggingConsoleKit.set,makeCausalConsole:o[25].makeCausalConsole.set,filterConsole:o[25].filterConsole.set,consoleWhitelist:o[25].consoleWhitelist.set}}),t[26]({imports(i){n(new Map(i),"../commons.js",0)},liveVar:{},onceVar:{makeRejectionHandlers:o[26].makeRejectionHandlers.set}}),t[27]({imports(i){let p=new Map(i);n(p,"../commons.js",0),n(p,"./assert.js",4),n(p,"./console.js",25),n(p,"./internal-types.js",1),n(p,"./types.js",3),n(p,"./unhandled-rejection.js",26)},liveVar:{},onceVar:{tameConsole:o[27].tameConsole.set}}),t[28]({imports(i){n(new Map(i),"../commons.js",0)},liveVar:{},onceVar:{filterFileName:o[28].filterFileName.set,shortenCallSiteString:o[28].shortenCallSiteString.set,tameV8ErrorConstructor:o[28].tameV8ErrorConstructor.set}}),t[29]({imports(i){let p=new Map(i);n(p,"../commons.js",0),n(p,"../whitelist.js",14),n(p,"./tame-v8-error-constructor.js",28)},liveVar:{},onceVar:{default:o[29].default.set}}),t[30]({imports(i){let p=new Map(i);n(p,"./commons.js",0),n(p,"./compartment-shim.js",20)},liveVar:{},onceVar:{getAnonymousIntrinsics:o[30].getAnonymousIntrinsics.set}}),t[31]({imports(i){let p=new Map(i);n(p,"./commons.js",0),n(p,"./error/assert.js",4)},liveVar:{},onceVar:{isTypedArray:o[31].isTypedArray.set,makeHardener:o[31].makeHardener.set}}),t[32]({imports(i){n(new Map(i),"./commons.js",0)},liveVar:{},onceVar:{default:o[32].default.set}}),t[33]({imports(i){n(new Map(i),"./commons.js",0)},liveVar:{},onceVar:{tameDomains:o[33].tameDomains.set}}),t[34]({imports(i){n(new Map(i),"./commons.js",0)},liveVar:{},onceVar:{default:o[34].default.set}}),t[35]({imports(i){n(new Map(i),"./commons.js",0)},liveVar:{},onceVar:{tameFunctionToString:o[35].tameFunctionToString.set}}),t[36]({imports(i){let p=new Map(i);n(p,"./commons.js",0),n(p,"./error/assert.js",4)},liveVar:{},onceVar:{default:o[36].default.set}}),t[37]({imports(i){n(new Map(i),"./commons.js",0)},liveVar:{},onceVar:{default:o[37].default.set}}),t[38]({imports(i){n(new Map(i),"./commons.js",0)},liveVar:{},onceVar:{default:o[38].default.set}}),t[39]({imports(i){let p=new Map(i);n(p,"./commons.js",0),n(p,"./whitelist.js",14)},liveVar:{},onceVar:{default:o[39].default.set}}),t[40]({imports(i){let p=new Map(i);n(p,"./commons.js",0),n(p,"./compartment-shim.js",20),n(p,"./enable-property-overrides.js",23),n(p,"./environment-options.js",24),n(p,"./error/assert.js",4),n(p,"./error/stringify-utils.js",2),n(p,"./error/tame-console.js",27),n(p,"./error/tame-error-constructor.js",29),n(p,"./get-anonymous-intrinsics.js",30),n(p,"./global-object.js",15),n(p,"./intrinsics.js",21),n(p,"./make-hardener.js",31),n(p,"./make-safe-evaluator.js",10),n(p,"./tame-date-constructor.js",32),n(p,"./tame-domains.js",33),n(p,"./tame-function-constructors.js",34),n(p,"./tame-function-tostring.js",35),n(p,"./tame-locale-methods.js",36),n(p,"./tame-math-object.js",37),n(p,"./tame-regexp-constructor.js",38),n(p,"./whitelist-intrinsics.js",39),n(p,"./whitelist.js",14)},liveVar:{},onceVar:{repairIntrinsics:o[40].repairIntrinsics.set,lockdown:o[40].lockdown.set}}),t[41]({imports(i){let p=new Map(i);n(p,"./src/commons.js",0),n(p,"./src/compartment-shim.js",20),n(p,"./src/error/assert.js",4),n(p,"./src/intrinsics.js",21),n(p,"./src/lockdown-shim.js",40),n(p,"./src/tame-function-tostring.js",35)},liveVar:{},onceVar:{}})})();var vt=Ae(!0,"SES","goldenrod"),Be=Ae(Ae.flags.ses,"SES","goldenrod"),{lockdown:ca,Compartment:pa}=globalThis,Ve,ua=t=>{if(delete globalThis.harden,!Ve){let e={consoleTaming:"unsafe",errorTaming:"unsafe",errorTrapping:"unsafe",stackFiltering:"verbose"},o={};vt.groupCollapsed("LOCKDOWN");try{ca(e||o);let n={...{log:Be,resolve:ar,html:sr,makeKey:ma,timeout:da},...t?.injections,harden:globalThis.harden};Ve=new pa({scope:n,...n}),vt.log("Particle Compartment ready")}finally{vt.groupEnd()}}},ar=Le.resolve.bind(Le),sr=(t,...e)=>`${t[0]}${e.map((o,l)=>`${o}${t[l+1]}`).join("")}`.trim(),ma=()=>`i${Math.floor((1+Math.random()*9)*1e14)}`,da=async(t,e)=>new Promise(o=>setTimeout(()=>o(t()),e)),ya=async(t,e)=>{let o=await ba(),l=await ga(t,e),n=va(t),i={log:n,resolve:ar,html:sr,...e?.injections},p=l(i);return d=>{let h={log:n,output:d.output.bind(d),service:d.service.bind(d)};return new o(p,h)}},ga=async(t,e)=>{let o=await We(t,e),l;try{l=Ve.evaluate(o)}catch(n){throw Be.error("failed to evaluate:",o),n}return typeof l=="object"&&(l=fa(l,t),Be(`repackaged factory:
`,l)),globalThis.harden(l)},fa=(t,e)=>{let{constNames:o,rewriteConsts:l,funcNames:n,rewriteFuncs:i}=ha(t),p=`{${[...o,...n]}}`,a=`
({log, ...utils}) => {
// protect utils
globalThis.harden(utils);
// these are just handy
const {assign, keys, entries, values, create} = Object;
// declarations
${[...l,...i].join(`

`)}
// hardened Object (map) of declarations,
// suitable to be a prototype
return globalThis.harden(${p});
// name the file for debuggers
//# sourceURL=sandbox/${De(e).split("/").pop()}
};
  `;return Be(`rewritten:

`,a),Ve.evaluate(a)},ha=t=>{let e=Object.entries(t),o=([c,r])=>typeof r=="function",l=([c,r])=>c=="harden"||c=="globalThis",n=e.filter(c=>o(c)&&!l(c)),i=n.map(([c,r])=>{let v=r?.toString?.()??"",s=v.includes("async"),m=v.replace("async ","").replace("function ","");return`${s?"async":""} function ${m};`}),p=n.map(([c])=>c),a=e.filter(c=>!o(c)&&!l(c)),d=a.map(([c,r])=>`const ${c} = \`${r}\`;`);return{constNames:a.map(([c])=>c),rewriteConsts:d,funcNames:p,rewriteFuncs:i}},wt,ba=async()=>{if(!wt){let t=await Te();wt=Ve.evaluate(t)}return wt},va=t=>{let e=Ae(Ae.flags.particles,t,"#002266");return(o,...l)=>{let i=(o?.stack?.split(`
`)?.slice(1,2)||new Error().stack?.split(`
`).slice(2,3)).map(p=>p.replace(/\([^()]*?\)/,"").replace(/ \([^()]*?\)/,"").replace("<anonymous>, <anonymous>","").replace("Object.","").replace("eval at :","").replace(/\(|\)/g,"").replace(/\[[^\]]*?\] /,"").replace(/at (.*) (\d)/,'at "$1" $2')).reverse().join(`
`).trim();o?.message?e.error(o.message,...l,`(${i})`):e(o,...l,`(${i})`)}};Pe.particleIndustry=ya;Pe.securityLockdown=ua;export{ua as initSes};
//# sourceMappingURL=ses.min.js.map
